(this["webpackJsonpjigsaw-puzzle"]=this["webpackJsonpjigsaw-puzzle"]||[]).push([[0],{59:function(e,t,s){},60:function(e,t,s){},70:function(e,t,s){},88:function(e,t,s){},89:function(e,t,s){"use strict";s.r(t);var n=s(2),a=s.n(n),r=s(20),o=s.n(r),i=s(17),c=s.n(i),l=s(23),h=s(4),u=s(6),p=s(11),d=s(10),m=s(97),g=s(98),b=s(99),j=function(){function e(t,s,n,a,r,o,i,c){Object(h.a)(this,e),this.group=t,this.key=t,this.col=s,this.row=n,this.pos=null!==a&&void 0!==a?a:{},this.imageOffset=r,this.zIndex=o,this.edges=i,this.neighbors=c}return Object(u.a)(e,[{key:"pos",get:function(){return this._pos},set:function(e){var t=e.left,s=e.top;this._pos={left:t,top:s},this._displayPos=this._pos}},{key:"displayPos",get:function(){return this._displayPos},set:function(e){var t=e.left,s=e.top;this._displayPos={left:t,top:s}}},{key:"clone",value:function(){var t=new e(this.key,this.col,this.row,this.pos,this.imageOffset,this.zIndex,this.edges,this.neighbors);return t.group=this.group,t.displayPos=this.displayPos,t}}]),e}(),f=s(14),v=s(51),O=s(18),x=s(21);function y(e){return Array.from(Array(e).keys())}function w(e){return Math.floor(Math.random()*Math.floor(e))}function k(e,t,s){if(t>s)throw Error("clamp: min (".concat(t,") is greater than max (").concat(s,")."));return Math.max(Math.min(e,s),t)}var P="b",z="r",S="f";function I(){var e=[P,z];return e[w(e.length)]}function N(e){switch(e){case P:return z;case z:return P;case S:throw Error("getOppositeEdge: Flat edge has no opposite type");default:throw Error("getOppositeEdge: Unknown edge type ".concat(e))}}var C=function(){function e(t,s,n,a,r){Object(h.a)(this,e),this.type=t,this.w=s,this.o=n,this.c1=a,this.c2=r}return Object(u.a)(e,[{key:"opposite",value:function(){return Object.assign(new e,this,{type:N(this.type)})}}]),e}(),D="Left",M="Top",U="Right",R="Bottom",B=Object(f.a)({},Symbol.iterator,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D;case 2:return e.next=4,M;case 4:return e.next=6,U;case 6:return e.next=8,R;case 8:case"end":return e.stop()}}),e)}))),F=function(){function e(t,s){var n;Object(h.a)(this,e),this.key=null!==s&&void 0!==s?s:t.key,this.pieces=[t.key],this.bounds=(n={},Object(f.a)(n,D,t.col),Object(f.a)(n,M,t.row),Object(f.a)(n,U,t.col),Object(f.a)(n,R,t.row),n)}return Object(u.a)(e,[{key:"addPiece",value:function(e){this.pieces.push(e.key),this.bounds.Left=Math.min(this.bounds.Left,e.col),this.bounds.Right=Math.max(this.bounds.Right,e.col),this.bounds.Top=Math.min(this.bounds.Top,e.row),this.bounds.Bottom=Math.max(this.bounds.Bottom,e.row)}},{key:"mergeWith",value:function(e){this.pieces=this.pieces.concat(e.pieces),this.bounds.Left=Math.min(this.bounds.Left,e.bounds.Left),this.bounds.Right=Math.max(this.bounds.Right,e.bounds.Right),this.bounds.Top=Math.min(this.bounds.Top,e.bounds.Top),this.bounds.Bottom=Math.max(this.bounds.Bottom,e.bounds.Bottom)}}]),e}(),L=s(1),H=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"getClipPathString",value:function(e){var t,s="",n=Object(O.a)(B);try{for(n.s();!(t=n.n()).done;){var a=t.value;s+=this.props.edgeDrawer.getPathString(a,e[a])}}catch(r){n.e(r)}finally{n.f()}return s}},{key:"render",value:function(){return Object(L.jsx)("clipPath",{id:"clip-"+this.props.pieceKey,children:Object(L.jsx)("path",{d:this.getClipPathString(this.props.edges)})})}}]),s}(n.PureComponent),E=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"renderClipPath",value:function(e){return Object(L.jsx)(H,{edgeDrawer:this.props.edgeDrawer,pieceKey:e.key,edges:e.edges},e.key)}},{key:"render",value:function(){var e,t=this,s=null===(e=this.props.pieces)||void 0===e?void 0:e.map((function(e){return t.renderClipPath(e)}));return Object(L.jsx)("svg",{width:"0",height:"0","aria-hidden":"true","data-testid":"clip-path-container",children:s})}}]),s}(n.PureComponent),T=function(){function e(t,s,n){Object(h.a)(this,e),this.templates=this.makeTemplates(t,s,n)}return Object(u.a)(e,[{key:"makeTemplates",value:function(e,t,s){var n={};return n.START="M ".concat(s," ").concat(t-s," "),n.bLeft=function(e,n,a,r){return"V ".concat((t+e)/2)+"C ".concat(s-n," ").concat(t/2+a," ",0," ").concat(t/2+r," ",0," ").concat(t/2," ")+"C ".concat(0," ",t/2-r," ").concat(s-n," ").concat(t/2-a," ").concat(s," ").concat((t-e)/2," ")},n.rLeft=function(e,n,a,r){return"V ".concat((t+e)/2)+"C ".concat(s+n," ").concat(t/2+a," ").concat(2*s," ").concat(t/2+r," ").concat(2*s," ").concat(t/2," ")+"C ".concat(2*s," ").concat(t/2-r," ").concat(s+n," ").concat(t/2-a," ").concat(s," ").concat((t-e)/2," ")},n.Left="V ".concat(s," "),n.bTop=function(t,n,a,r){return"H ".concat((e-t)/2," ")+"C ".concat(e/2-a," ").concat(s-n," ").concat(e/2-r," ",0," ").concat(e/2," ",0," ")+"C ".concat(e/2+r," ",0," ").concat(e/2+a," ").concat(s-n," ").concat((e+t)/2," ").concat(s," ")},n.rTop=function(t,n,a,r){return"H ".concat((e-t)/2," ")+"C ".concat(e/2-a," ").concat(s+n,"  ").concat(e/2-r," ").concat(2*s," ").concat(e/2," ").concat(2*s," ")+"C ".concat(e/2+r," ").concat(2*s," ").concat(e/2+a," ").concat(s+n," ").concat((e+t)/2," ").concat(s," ")},n.Top="H ".concat(e-s," "),n.bRight=function(n,a,r,o){return"V ".concat((t-n)/2," ")+"C ".concat(e-s+a," ").concat(t/2-r," ").concat(e," ").concat(t/2-o," ").concat(e," ").concat(t/2," ")+"C ".concat(e," ").concat(t/2+o," ").concat(e-s+a," ").concat(t/2+r," ").concat(e-s," ").concat((t+n)/2," ")},n.rRight=function(n,a,r,o){return"V ".concat((t-n)/2," ")+"C ".concat(e-s-a," ").concat(t/2-r," ").concat(e-2*s," ").concat(t/2-o," ").concat(e-2*s," ").concat(t/2," ")+"C ".concat(e-2*s," ").concat(t/2+o," ").concat(e-s-a," ").concat(t/2+r," ").concat(e-s," ").concat((t+n)/2," ")},n.Right="V ".concat(t-s," "),n.bBottom=function(n,a,r,o){return"H ".concat((e+n)/2," ")+"C ".concat(e/2+r," ").concat(t-s+a," ").concat(e/2+o," ").concat(t," ").concat(e/2," ").concat(t," ")+"C ".concat(e/2-o," ").concat(t," ").concat(e/2-r," ").concat(t-s+a," ").concat((e-n)/2," ").concat(t-s," ")},n.rBottom=function(n,a,r,o){return"H ".concat((e+n)/2," ")+"C ".concat(e/2+r," ").concat(t-s-a,"  ").concat(e/2+o," ").concat(t-2*s," ").concat(e/2," ").concat(t-2*s," ")+"C ".concat(e/2-o," ").concat(t-2*s," ").concat(e/2-r," ").concat(t-s-a," ").concat((e-n)/2," ").concat(t-s," ")},n.Bottom="Z",n}},{key:"getPathString",value:function(e,t){var s=e===D?this.templates.START:"",n=this.templates[e],a="";if(t.type!==S){var r=t.type+e;a=this.templates[r](t.w,t.o,t.c1,t.c2)}return s+a+n}}]),e}(),W=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"render",value:function(){var e=this.props.model;return Object(L.jsx)("div",{style:{left:e.displayPos.left,top:e.displayPos.top,position:"absolute"},children:Object(L.jsx)("svg",{className:"puzzle-piece","aria-label":"Puzzle piece","data-id":e.key,width:this.props.width,height:this.props.height,clipPath:"url(#clip-".concat(e.key,")"),style:{zIndex:e.zIndex>0?e.zIndex:"auto"},onPointerDown:this.props.onPointerDown,children:Object(L.jsx)("image",{href:this.props.imgUrl,x:this.props.model.imageOffset.left,y:this.props.model.imageOffset.top,onDragStart:function(e){return e.preventDefault()}})})})}}]),s}(n.PureComponent),A=s(25),K=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state=Object(A.a)({},e.props.startPos),e.handleTransitionEnd=function(){e.setState({animationComplete:!0})},e}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var e=this;requestAnimationFrame((function(){return requestAnimationFrame((function(){return e.setState({top:0,left:0})}))}))}},{key:"render",value:function(){return Object(L.jsx)("img",{className:"puzzle-complete-img",src:this.props.imgUrl,alt:"Completed puzzle",width:this.props.width,height:this.props.height,style:this.state,onTransitionEnd:this.handleTransitionEnd})}}]),s}(n.Component),G=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).imgUrl=e.props.imgUrl,e.imgWidth=e.props.imgWidth,e.imgHeight=e.props.imgHeight,e.pieceWidth=e.props.pieceWidth,e.pieceHeight=e.props.pieceHeight,e.edgeDrawer=new T(e.props.pieceWidth,e.props.pieceHeight,e.props.borderSize),e}return Object(u.a)(s,[{key:"getPuzzleOffsetFromCenter",value:function(){var e=this.props.getBoardDimensions(),t=this.props.pieces.find((function(e){return 0===e.row&&0===e.col})).key,s=this.props.pieces[t].pos,n=(e.width/this.props.scaleFactor-this.props.imgWidth)/2,a=(e.height/this.props.scaleFactor-this.props.imgHeight)/2;return{left:s.left+this.props.borderSize-n,top:s.top+this.props.borderSize-a}}},{key:"renderPiece",value:function(e){return Object(L.jsx)(W,{model:e,width:this.pieceWidth,height:this.pieceHeight,imgUrl:this.imgUrl,onPointerDown:this.props.pointerDownHandlers[e.key]},e.key)}},{key:"render",value:function(){var e=this,t=this.props,s=t.scaleFactor,n=t.pieces,a=t.draggedPiece,r=t.gameComplete,o=t.onPointerMove,i=t.onPointerUp,c={transform:"scale(".concat(s,")"),width:100/s+"%",height:100/s+"%"},l=r?Object(L.jsx)("div",{className:"puzzle-area",style:c,children:Object(L.jsx)(K,{imgUrl:this.imgUrl,startPos:this.getPuzzleOffsetFromCenter(),width:this.imgWidth,height:this.imgHeight})}):Object(L.jsxs)("div",{className:"puzzle-area"+(null!==a?" no-scroll":""),style:c,onPointerMove:o,onPointerUp:i,children:[Object(L.jsx)(E,{edgeDrawer:this.edgeDrawer,pieces:n}),null===n||void 0===n?void 0:n.map((function(t){return e.renderPiece(t)}))]});return Object(L.jsxs)("div",{className:"puzzle-container pt-2 pb-3",children:[Object(L.jsx)("div",{className:"puzzle-background"}),l]})}}]),s}(n.Component),V=(s(59),function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(h.a)(this,s),(n=t.call(this,e)).innerWidth=n.props.imgWidth/n.props.cols,n.innerHeight=n.props.imgHeight/n.props.rows,n.borderSize=Math.min(n.innerHeight,n.innerWidth)/4,n.pieceWidth=2*n.borderSize+n.innerWidth,n.pieceHeight=2*n.borderSize+n.innerHeight,n.nextzIndex=1,n.state={scaleFactor:void 0,offsetX:void 0,offsetY:void 0,pieces:void 0,draggedPiece:null,gameComplete:!1,endAnimationComplete:!1},n.handlePointerDown=function(e,t){if(null===n.state.draggedPiece&&t.isPrimary&&("mouse"!==t.pointerType||0===t.button)){var s,a=n.state.pieces.slice(),r=a[e].group,o=Object(O.a)(n.groups.get(r).pieces);try{for(o.s();!(s=o.n()).done;){var i=s.value;a[i]=a[i].clone(),a[i].zIndex=n.nextzIndex,a[i].pos=a[i].displayPos}}catch(c){o.e(c)}finally{o.f()}n.nextzIndex++,n.setState({pieces:a,draggedPiece:e,offsetX:t.clientX-a[e].pos.left*n.state.scaleFactor,offsetY:t.clientY-a[e].pos.top*n.state.scaleFactor})}},n.handlePointerMove=function(e){if(null!==n.state.draggedPiece&&e.isPrimary&&document.elementsFromPoint(e.clientX,e.clientY).some((function(e){return e.classList.contains("puzzle-area")}))){var t=n.state.pieces.slice(),s=t[n.state.draggedPiece].clone();t[n.state.draggedPiece]=s;var a=(e.clientX-n.state.offsetX)/n.state.scaleFactor,r=(e.clientY-n.state.offsetY)/n.state.scaleFactor;s.pos={left:a,top:r};var o,i=n.groups.get(s.group),c=Object(O.a)(i.pieces);try{for(c.s();!(o=c.n()).done;){var l=o.value;l!==n.state.draggedPiece&&(t[l]=t[l].clone(),n.alignPiece(t[l],s))}}catch(h){c.e(h)}finally{c.f()}n.setState({pieces:t})}},n.handlePointerUp=function(){if(null!==n.state.draggedPiece){var e,t=n.state.pieces.slice(),s=t[n.state.draggedPiece].group,a=Object(O.a)(n.groups.get(s).pieces);try{for(a.s();!(e=a.n()).done;){var r,o=t[e.value],i=Object(O.a)(B);try{for(i.s();!(r=i.n()).done;){var c=r.value,l=t[o.neighbors[c]];l&&l.group!==o.group&&n.isTouching(o,c,l)&&n.mergeGroups(t,o.group,l.group)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}var h=1===n.groups.size;n.setState({pieces:t,gameComplete:h,draggedPiece:null})}},n.handleResize=function(){var e=n.setScaleFactor();n.clampPiecesToBoardBounds(e)},n.getGameState=function(){return n.state.pieces},n.pointerDownHandlers=y(n.props.rows*n.props.cols).map((function(e){return n.handlePointerDown.bind(Object(x.a)(n),e)})),n}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this.setScaleFactor();if(window.addEventListener("resize",this.handleResize),this.props.pieces){var s=this.props.pieces;this.groups=this.createGroups(s),this.setState({pieces:s},(function(){return e.clampPiecesToBoardBounds(e.state.scaleFactor)}))}else{var n=this.createPieces(t);this.groups=this.createGroups(n),this.setState({pieces:n})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"setScaleFactor",value:function(){var e=.7*document.documentElement.clientWidth/this.props.imgWidth,t=.7*document.documentElement.clientHeight/this.props.imgHeight,s=Math.min(e,t);return this.setState({scaleFactor:s}),s}},{key:"getBoardDimensions",value:function(){var e=document.querySelector(".puzzle-background");return{width:e.clientWidth,height:e.clientHeight}}},{key:"clampPiecesToBoardBounds",value:function(e){var t,s=this.getBoardDimensions(),n=s.width/e-this.pieceWidth,a=s.height/e-this.pieceHeight,r=this.state.pieces.slice(),o=Object(O.a)(r.entries());try{for(o.s();!(t=o.n()).done;){var i=Object(v.a)(t.value,2),c=i[0],l=i[1],h=this.groups.get(l.group),u=n-this.innerWidth*(h.bounds.Right-l.col),p=a-this.innerHeight*(h.bounds.Bottom-l.row);r[c]=l.clone(),r[c].displayPos={left:Math.min(l.pos.left,u),top:Math.min(l.pos.top,p)}}}catch(d){o.e(d)}finally{o.f()}this.setState({pieces:r})}},{key:"getGridPosition",value:function(e,t,s){return{left:(this.innerWidth+s)*e-this.borderSize,top:(this.innerHeight+s)*t-this.borderSize}}},{key:"getRandomPosition",value:function(e){var t=this.getBoardDimensions();return t.width>t.height?{left:Math.random()*(.15*t.width/e),top:Math.random()*(t.height/e-this.pieceHeight)}:{left:Math.random()*(t.width/e-this.pieceWidth),top:Math.random()*(.15*t.height)/e}}},{key:"getPieceImageOffset",value:function(e,t){return{left:-this.innerWidth*e+this.borderSize,top:-this.innerHeight*t+this.borderSize}}},{key:"createEdge",value:function(e){var t=this.borderSize*(.8+.45*Math.random()),s=this.borderSize*(.4+.1*Math.random()),n=t>this.borderSize?t*(.75+.25*Math.random()):this.borderSize*(.85+.35*Math.random()),a=t*(.5+.15*Math.random());return new C(e,t,s,n,a)}},{key:"createPieces",value:function(e){for(var t=this,s=[],n=y(this.props.cols*this.props.rows),a=Array(this.props.cols).fill(null).map((function(){return Array(t.props.rows)})),r=0;r<this.props.cols;r++)for(var o=0;o<this.props.rows;o++){var i,c=n.splice(w(n.length),1)[0];a[r][o]=c;var l=this.getRandomPosition(e),h=this.getPieceImageOffset(r,o),u={};r>0&&(u.Left=a[r-1][o],s[u.Left].neighbors.Right=c),o>0&&(u.Top=a[r][o-1],s[u.Top].neighbors.Bottom=c);var p=(i={},Object(f.a)(i,D,0===r?this.createEdge(S):s[u.Left].edges.Right.opposite()),Object(f.a)(i,M,0===o?this.createEdge(S):s[u.Top].edges.Bottom.opposite()),Object(f.a)(i,U,r===this.props.cols-1?this.createEdge(S):this.createEdge(I())),Object(f.a)(i,R,o===this.props.rows-1?this.createEdge(S):this.createEdge(I())),i);s[c]=new j(c,r,o,l,h,0,p,u)}return s}},{key:"createGroups",value:function(e){var t=new Map;return e.forEach((function(e){var s=t.get(e.group);s?s.addPiece(e):t.set(e.group,new F(e,e.group))})),t}},{key:"alignPiece",value:function(e,t){e.pos={left:t.displayPos.left+this.innerWidth*(e.col-t.col),top:t.displayPos.top+this.innerHeight*(e.row-t.row)}}},{key:"isTouching",value:function(e,t,s){var n=7/this.state.scaleFactor;return t===U?Math.abs(e.displayPos.top-s.displayPos.top)<=n&&Math.abs(s.displayPos.left-e.displayPos.left-this.innerWidth)<=n:t===D?Math.abs(e.displayPos.top-s.displayPos.top)<=n&&Math.abs(e.displayPos.left-s.displayPos.left-this.innerWidth)<=n:t===M?Math.abs(e.displayPos.left-s.displayPos.left)<=n&&Math.abs(e.displayPos.top-s.displayPos.top-this.innerHeight)<=n:t===R?Math.abs(e.displayPos.left-s.displayPos.left)<=n&&Math.abs(s.displayPos.top-e.displayPos.top-this.innerHeight)<=n:void 0}},{key:"mergeGroups",value:function(e,t,s){var n,a=e[this.groups.get(t).pieces[0]],r=Object(O.a)(this.groups.get(s).pieces);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=e[o].clone();i.group=t,i.zIndex=a.zIndex,this.alignPiece(i,a),e[o]=i}}catch(c){r.e(c)}finally{r.f()}this.groups.get(t).mergeWith(this.groups.get(s)),this.groups.delete(s)}},{key:"render",value:function(){return Object(L.jsx)(G,{imgUrl:this.props.imgUrl,imgWidth:this.props.imgWidth,imgHeight:this.props.imgHeight,pieceWidth:this.pieceWidth,pieceHeight:this.pieceHeight,borderSize:this.borderSize,scaleFactor:this.state.scaleFactor,gameComplete:this.state.gameComplete,pieces:this.state.pieces,draggedPiece:this.state.draggedPiece,getBoardDimensions:this.getBoardDimensions,onPointerMove:this.handlePointerMove,onPointerUp:this.handlePointerUp,pointerDownHandlers:this.pointerDownHandlers})}}]),s}(n.Component)),_=s(102),q=s(100),Y=s(101),X=s(91),J=s(92),Q=s(93),Z=function e(t,s,n,a,r,o,i,c){Object(h.a)(this,e),this.type=t,this.name=s,this.url=n,this.defaultRows=a,this.defaultCols=r,this.author=o,this.source=i,this.shortName=null!==c&&void 0!==c?c:s},$=function e(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";Object(h.a)(this,e),this.sourceName=t,this.nameIsTitle=s,this.sourceUrl=a,this.isPhoto=n,this.description=r},ee=function e(t,s,n){Object(h.a)(this,e),this.type=t,this.statusCode=s,this.details=n},te=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"getErrorDisplay",value:function(){var e=this.props.error;if(429===e.statusCode&&"upstream"===e.type)return{title:"Rate limit exceeded (API)",text:Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("p",{children:"The hourly limit for requests from this site to the Unsplash server has been reached."}),Object(L.jsxs)("p",{children:["Feel free to ",Object(L.jsx)("a",{className:"alert-link",href:"https://github.com/turtleseason/jigsaw-puzzle/issues",rel:"external",children:"open an issue on GitHub"})," ","to let me know - ",Object(L.jsx)("br",{}),"if this happens often, I can look into applying for a higher rate limit."]})]})};if(429===e.statusCode&&"proxy"===e.type)return{title:"Rate limit exceeded (API Proxy)",text:Object(L.jsxs)("p",{children:["Please try again in a moment.",Object(L.jsx)("br",{}),"(If you get this error frequently, feel free to "," ",Object(L.jsx)("a",{className:"alert-link",href:"https://github.com/turtleseason/jigsaw-puzzle/issues",rel:"external",children:"open an issue on GitHub"})," ","and let me know.)"]})};var t="network"===e.type?"Network error":"Status code ".concat(e.statusCode," (").concat(e.type,")"),s=e.details?" - "+e.details:null;return{title:"Something went wrong :0",text:Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("p",{children:Object(L.jsxs)("small",{className:"",children:["Error details: ",t,s]})}),Object(L.jsxs)("p",{children:["Please try again. If you keep getting an error, feel free to "," ",Object(L.jsx)("a",{className:"alert-link",href:"https://github.com/turtleseason/jigsaw-puzzle/issues",rel:"external",children:"open an issue on GitHub"})," ","and let me know."]})]})}}},{key:"render",value:function(){if(!this.props.error)return null;var e=this.getErrorDisplay();return Object(L.jsxs)("div",{className:"search-error alert alert-warning text-center",role:"alert",children:[Object(L.jsx)("h6",{className:"alert-heading",children:e.title}),e.text,Object(L.jsxs)("p",{className:"mt-n2",children:["You can still search photos directly on ",Object(L.jsx)("a",{href:"https://unsplash.com/",target:"_blank",rel:"external noreferrer",children:"Unsplash.com"}),","," ","download an image to your computer, and load it using the file selector."]})]})}}]),s}(n.Component),se=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"handleImageClick",value:function(e){this.props.chooseImage(this.props.images[this.props.page][e])}},{key:"handleKeyDown",value:function(e,t){"Enter"!==t.key&&"Space"!==t.key||"A"===t.target.tagName||(this.props.chooseImage(this.props.images[this.props.page][e]),t.preventDefault())}},{key:"renderImage",value:function(e,t){var s=this,n=this.props.selectedImage===e;return Object(L.jsx)("div",{"data-testid":"result",className:"result-container mb-2",tabIndex:"0",onClick:function(){return s.handleImageClick(t)},onKeyDown:function(e){return s.handleKeyDown(t,e)},children:Object(L.jsx)("div",{className:"result ".concat(n?"result-selected":""),children:Object(L.jsxs)("div",{className:"placeholder",style:{paddingTop:e.height/e.width*100+"%"},children:[Object(L.jsx)("img",{src:e.urls.small,alt:e.alt_description}),Object(L.jsxs)("span",{className:"badge badge-dark",children:["By ",Object(L.jsx)("a",{className:"text-light",href:e.user.links.html,rel:"external noreferrer",target:"_blank",children:e.user.name})," ","on ",Object(L.jsx)("a",{className:"text-light",href:e.links.html,rel:"external noreferrer",target:"_blank",children:"Unsplash"})]})]})})},e.id)}},{key:"render",value:function(){var e=this,t=this.props.images[this.props.page],s=Object(L.jsx)("div",{className:"text-secondary",children:"Image results will go here, and it will be very cool."}),n=Object(L.jsx)("div",{className:"text-secondary",children:"No results found. :("}),a=Object(L.jsx)("div",{className:"spinner-border my-1",role:"status",children:Object(L.jsx)("span",{className:"sr-only",children:"Loading..."})});return Object(L.jsxs)("div",{className:"search-results-container text-center",children:[this.props.isLoading||t?null:s,!this.props.isLoading&&t&&0===t.length?n:null,this.props.isLoading?a:null,Object(L.jsx)("div",{className:"search-results",children:null===t||void 0===t?void 0:t.map((function(t,s){return e.renderImage(t,s)}))})]})}}]),s}(n.Component),ne=s(52),ae=["currentPage","minPage","maxPage","numPageLinks","onPageChange","className","ariaLabel"],re=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"handleNavigate",value:function(e,t){e.preventDefault(),this.props.onPageChange&&this.props.onPageChange(t)}},{key:"renderPageLinks",value:function(){var e=this,t=[],s=this.props.currentPage-this.props.numPageLinks-1,n=this.props.currentPage+this.props.numPageLinks+1;s>=this.props.minPage?t.push(Object(L.jsx)("li",{children:Object(L.jsx)("span",{className:"btn",style:{cursor:"default"},children:"..."})},s)):t.push(Object(L.jsx)("li",{className:"invisible"},s));for(var a=function(s){var n=null;s===e.props.currentPage?n=Object(L.jsx)("span",{className:"btn",style:{cursor:"default"},children:s}):s>=e.props.minPage&&s<=e.props.maxPage&&(n=Object(L.jsx)("button",{className:"btn btn-link",type:"button",onClick:function(t){return e.handleNavigate(t,s)},children:s})),t.push(Object(L.jsx)("li",{className:n?null:"invisible",children:n},s))},r=s+1;r<n;r++)a(r);return n<=this.props.maxPage?t.push(Object(L.jsx)("li",{children:Object(L.jsx)("span",{className:"btn",style:{cursor:"default"},children:"..."})},n)):t.push(Object(L.jsx)("li",{className:"invisible"},n)),Object(L.jsx)("ul",{children:t})}},{key:"render",value:function(){var e=this,t=this.props,s=t.currentPage,n=t.minPage,a=t.maxPage,r=(t.numPageLinks,t.onPageChange,t.className),o=t.ariaLabel,i=Object(ne.a)(t,ae),c="custom-pagination container "+(r||""),l=o||"Search results pages",h=s<=n,u=s>=a,p=this.renderPageLinks();return Object(L.jsx)("nav",Object(A.a)(Object(A.a)({className:c,"aria-label":l},i),{},{children:Object(L.jsxs)("div",{className:"row justify-content-between align-items-center",children:[Object(L.jsx)("div",{className:"col-auto p-0",children:Object(L.jsx)("button",{className:"btn btn-link"+(h?" invisible":""),type:"button",onClick:h?null:function(t){return e.handleNavigate(t,s-1)},children:"< Back"})}),Object(L.jsx)("div",{className:"col-auto",children:p}),Object(L.jsx)("div",{className:"col-auto p-0",children:Object(L.jsx)("button",{className:"btn btn-link"+(u?" invisible":""),type:"button",onClick:u?null:function(t){return e.handleNavigate(t,s+1)},children:"More >"})})]})}))}}]),s}(n.Component);re.defaultProps={minPage:1,maxPage:Number.MAX_SAFE_INTEGER,numPageLinks:1};s(60);var oe=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).proxyUrl="https://ni8jay6n41.execute-api.us-west-2.amazonaws.com",e.searchBoxRef=a.a.createRef(),e.state={images:[],page:1,maxPage:1,searchString:"",isSearchStringValid:!0,isSearchLoading:!1,error:null,selectedImage:null},e.handleInputChange=function(t){e.setState({searchString:t.target.value})},e.handleInputKeyDown=function(t){"Enter"===t.key&&(e.handleSearchButtonClick(),t.preventDefault())},e.handlePageChange=function(t){e.state.isSearchLoading||(t=k(t=Math.floor(t),1,10),requestAnimationFrame((function(){return e.searchBoxRef.current.scrollIntoView()})),e.state.images[t-1]?e.setState({page:t}):e.searchImages(t))},e.handleSearchButtonClick=function(){e.setState({images:[]},(function(){return e.searchImages(1)}))},e.handleChooseButtonClick=function(){e.chooseImage(),e.props.toggleModal()},e.selectImage=function(t){e.setState({selectedImage:t})},e}return Object(u.a)(s,[{key:"getSearchUrl",value:function(e,t){return"".concat(this.proxyUrl,"/search/").concat(encodeURIComponent(e),"/page/").concat(t)}},{key:"getDownloadUrl",value:function(e){return"".concat(this.proxyUrl,"/download/").concat(e)}},{key:"addImages",value:function(e,t,s){var n=this.state.images.slice();n[t-1]=e;var a=Math.min(s,10);this.setState({images:n,page:t,maxPage:a})}},{key:"chooseImage",value:function(){var e=this.state.selectedImage,t=this.props.generateDefaultDimensions(e.width,e.height);this.props.setImage(new Z("unsplash","Unsplash Photo (".concat(e.id,")"),e.urls.regular,t.rows,t.cols,e.user.name,new $("Unsplash",!1,!0,e.links.html))),this.trackDownload(e.id)}},{key:"validateQuery",value:function(e){var t=e&&!/^\s*$/.test(e);return this.setState({isSearchStringValid:t}),t}},{key:"searchImages",value:function(e){var t=this,s=this.state.searchString;this.validateQuery(s)&&(this.setState({isSearchLoading:!0}),fetch(this.getSearchUrl(s,e)).then((function(e){if(!e.ok)throw console.warn("Proxy server returned an error: ".concat(e.status,", ").concat(e.statusText)),t.setState({error:new ee("proxy",e.status,e.statusText)}),new Error("Failed response: ".concat(e.status,", ").concat(e.statusText));return e.json()})).then((function(s){if(s.errors)throw console.warn("Upstream server returned an error (status code ".concat(s.status,"):\n                    ").concat(s.errors.join(", "))),t.setState({error:new ee("upstream",s.status,s.errors.join(", "))}),new Error("Upstream failed response (status code ".concat(s.status,"):\n                    ").concat(s.errors.join(", ")));t.setState({error:null}),t.addImages(s.response.results,e,s.response.total_pages)})).catch((function(e){e instanceof TypeError&&t.setState({error:new ee("network")}),console.warn("".concat(e.name,": ").concat(e.message))})).finally((function(){t.setState({isSearchLoading:!1})})))}},{key:"trackDownload",value:function(e){fetch(this.getDownloadUrl(e)).then((function(e){if(e.ok)return e.json();throw new Error("".concat(e.status," ").concat(e.statusText))})).then((function(e){if("success"!==e.type)throw new Error("".concat(e.status," - ").concat(e.errors.join(", ")," (upstream)"))})).catch((function(t){return console.warn("Image ".concat(e," download failed. Error:"),t.message)}))}},{key:"render",value:function(){var e=this.state.images[this.state.page-1]&&this.state.images[this.state.page-1].length>0;return Object(L.jsxs)(Y.a,{toggle:this.props.toggleModal,isOpen:this.props.isOpen,scrollable:!0,size:"lg",centered:!0,children:[Object(L.jsx)(X.a,{toggle:this.props.toggleModal,children:"Find images"}),Object(L.jsxs)(J.a,{children:[Object(L.jsx)("p",{children:"Browse images from Unsplash.com by searching below."}),Object(L.jsxs)("div",{className:"form-group row mx-0",ref:this.searchBoxRef,children:[Object(L.jsx)("label",{className:"col-form-label mr-2",htmlFor:"img-search-input",children:"Search by keyword"}),Object(L.jsx)("input",{className:"col col-lg-4 form-control ".concat(this.state.isSearchStringValid?"":"is-invalid"," px-2 mr-2"),id:"img-search-input",type:"text",value:this.state.searchString,"aria-describedby":"searchValidationFeedback",onKeyDown:this.handleInputKeyDown,onChange:this.handleInputChange}),Object(L.jsx)("button",{className:"btn btn-dark mr-auto",type:"button",onClick:this.handleSearchButtonClick,children:"Search"}),Object(L.jsx)("div",{className:"w-100 d-lg-none"}),Object(L.jsx)("div",{className:"col invalid-feedback align-self-center",id:"searchValidationFeedback",children:"Please enter a search term."})]}),Object(L.jsx)(te,{error:this.state.error}),Object(L.jsx)(se,{images:this.state.images,page:this.state.page-1,isLoading:this.state.isSearchLoading,selectedImage:this.state.selectedImage,chooseImage:this.selectImage})]}),Object(L.jsxs)(Q.a,{className:"flex-sm-nowrap",children:[e?Object(L.jsx)(re,{className:"mr-sm-3",currentPage:this.state.page,maxPage:this.state.maxPage,onPageChange:this.handlePageChange}):null,Object(L.jsx)("button",{className:"btn btn-dark flex-shrink-0",type:"button",disabled:!this.state.selectedImage,onClick:this.handleChooseButtonClick,children:"Use selected image"})]})]})}}]),s}(n.Component),ie=s.p+"static/media/ito-jakuchu-red-parrot-on-the-branch-of-a-tree.a8f36cd5.jpg",ce=s.p+"static/media/david-clode-eOSqRq2Qm1c-unsplash.42540cb6.jpg",le=s.p+"static/media/casey-horner-80UR4DM2Rz0-unsplash.001ae9f7.jpg",he=s.p+"static/media/van-gogh-roses-nga.8fa9d120.jpg",ue=s.p+"static/media/scott-webb-lYzgtps0UtQ-unsplash.509dd0a5.jpg",pe=s.p+"static/media/travel-sourced-FsmcD6uKcHk-unsplash.97041d06.jpg",de=[new Z("preset","Red Parrot on the Branch of a Tree",ie,6,8,"It\u014d Jakuch\u016b",new $("Metropolitan Museum of Art",!0,!1,"https://www.metmuseum.org/art/collection/search/57123"),"Red Parrot"),new Z("preset","Coral",ce,7,10,"David Clode",new $("Unsplash",!1,!0,"https://unsplash.com/photos/eOSqRq2Qm1c")),new Z("preset","Starry Sky",le,7,10,"Casey Horner",new $("Unsplash",!1,!0,"https://unsplash.com/photos/80UR4DM2Rz0")),new Z("preset","Roses",he,8,10,"Vincent van Gogh",new $("National Gallery of Art",!0,!1,"https://www.nga.gov/collection/art-object-page.72328.html")),new Z("preset","Succulents",ue,8,5,"Scott Webb",new $("Unsplash",!1,!0,"https://unsplash.com/photos/lYzgtps0UtQ")),new Z("preset","Jellyfish",pe,7,10,"Travel Sourced",new $("Unsplash",!1,!0,"https://unsplash.com/photos/FsmcD6uKcHk"))],me=(s(70),function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).fileInput=a.a.createRef(),e.selectedPreset=de[0],e.userImage=null,e.state={selectedOption:"preset0",usingUserImage:!1,invalidUserImage:!1,unsplashImage:null,modalOpen:!1},e.usePresetImage=function(){e.setState({usingUserImage:!1}),e.props.setSelectedImage(e.selectedPreset)},e.useUserImage=function(){e.setState({usingUserImage:!0}),e.props.setSelectedImage(e.userImage)},e.setPresetImage=function(t){e.selectedPreset=t,e.props.setSelectedImage(t)},e.setUnsplashImage=function(t){e.setState({unsplashImage:t,selectedOption:"unsplash"}),e.setPresetImage(t)},e.handleRadioKeyDown=function(e){switch(e.key){case"ArrowLeft":case"ArrowUp":return void("radioBtn2"===e.target.id&&(document.getElementById("radioBtn1").focus(),e.preventDefault()));case"ArrowRight":case"ArrowDown":return void("radioBtn1"===e.target.id&&(document.getElementById("radioBtn2").focus(),e.preventDefault()));default:return}},e.handleSelectChange=function(t){e.usePresetImage();var s=t.target;s.selectedIndex===s.length-1?e.toggleModal():s.selectedIndex===s.length-2&&e.state.unsplashImage?(e.setPresetImage(e.state.unsplashImage),e.setState({selectedOption:"unsplash"})):-1!==s.selectedIndex&&(e.setPresetImage(de[s.selectedIndex]),e.setState({selectedOption:"preset"+s.selectedIndex}))},e.handleFileChange=function(){e.useUserImage();var t=e.fileInput.current.files[0],s=URL.createObjectURL(t),n=new Image;n.onerror=function(){URL.revokeObjectURL(s),e.userImage&&URL.revokeObjectURL(e.userImage.url),e.userImage=null,e.setState({invalidUserImage:!0}),e.props.setSelectedImage(null)},n.onload=function(){e.userImage&&URL.revokeObjectURL(e.userImage.url);var a=e.generateDefaultDimensions(n.naturalWidth,n.naturalHeight);e.userImage=new Z("user",t.name,s,a.rows,a.cols),e.setState({invalidUserImage:!1}),e.props.setSelectedImage(e.userImage)},n.src=s},e.generateDefaultDimensions=function(t,s){var n=e.props.minPuzzleDimension,a=t/s,r=k(Math.round(12/(a+1)),n,12-n);return{rows:r,cols:12-r}},e.toggleModal=function(){e.setState({modalOpen:!e.state.modalOpen})},e}return Object(u.a)(s,[{key:"renderSelectOptions",value:function(){for(var e=[],t=0;t<de.length;t++){var s=de[t];e.push(Object(L.jsx)("option",{value:"preset"+t,children:s.shortName},t))}return e.push(Object(L.jsx)("option",{disabled:!0,children:"\u2015\u2015\u2015\u2015\u2015\u2015\u2015"},-1)),this.state.unsplashImage&&e.push(Object(L.jsx)("option",{value:"unsplash",children:"Unsplash photo by ".concat(this.state.unsplashImage.author)},-2)),e.push(Object(L.jsx)("option",{children:"More..."},-3)),e}},{key:"render",value:function(){var e=this.state.usingUserImage?"btn-outline-dark":"btn-dark",t=this.state.usingUserImage?"btn-dark":"btn-outline-dark";return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("div",{className:"input-group",children:[Object(L.jsx)("div",{className:"input-group-prepend col-12 col-lg-6 pr-lg-0",children:Object(L.jsxs)("div",{className:"btn ".concat(e," d-flex flex-wrap flex-sm-nowrap align-items-center w-100 br-when-stacked"),onClick:this.usePresetImage,children:[Object(L.jsx)("input",{readOnly:!0,className:"col-auto",id:"radioBtn1",type:"radio",checked:!this.state.usingUserImage,onKeyDown:this.handleRadioKeyDown}),Object(L.jsx)("label",{className:"col col-sm-4 col-md-3 col-lg-auto col-form-label",htmlFor:"radioBtn1",children:"Choose an image:"}),Object(L.jsx)("div",{className:"w-100 d-sm-none"}),Object(L.jsx)("label",{className:"sr-only",htmlFor:"puzzle-image-select",children:"Select image"}),Object(L.jsx)("select",{className:"custom-select col",id:"puzzle-image-select",value:this.state.selectedOption,onChange:this.handleSelectChange,children:this.renderSelectOptions()}),Object(L.jsx)("button",{className:"btn btn-link p-0 ml-2",type:"button","aria-label":"Find more images",style:{color:"inherit"},onClick:this.toggleModal,children:Object(L.jsx)("i",{className:"bi-search icon-lg"})})]})}),Object(L.jsx)("div",{className:"input-group-append col-12 col-lg-6 pl-lg-0",children:Object(L.jsxs)("div",{className:"btn ".concat(t," d-flex flex-wrap flex-sm-nowrap align-items-center w-100 br-when-stacked"),onClick:this.useUserImage,children:[Object(L.jsx)("input",{readOnly:!0,className:"col-auto order-first order-lg-last ml-lg-3",id:"radioBtn2",type:"radio",checked:this.state.usingUserImage,onKeyDown:this.handleRadioKeyDown}),Object(L.jsx)("label",{className:"col col-sm-4 col-md-3 col-lg-auto col-form-label",htmlFor:"radioBtn2",children:"Or use your own:"}),Object(L.jsx)("div",{className:"w-100 d-sm-none"}),Object(L.jsx)(_.a,{className:"col text-left",id:"file-input",type:"file",accept:"image/*",innerRef:this.fileInput,invalid:this.state.invalidUserImage,onChange:this.handleFileChange}),Object(L.jsx)("button",{className:"btn btn-link p-0 ml-2",id:"show-tooltip",type:"button",style:{color:"inherit"},onClick:function(e){e.preventDefault(),e.stopPropagation()},children:Object(L.jsx)("i",{className:"bi-info-circle icon-lg"})})]})})]}),Object(L.jsx)(q.a,{placement:"top",target:"show-tooltip",children:"Images are only used locally in your browser and are never uploaded or sent over the Internet."}),Object(L.jsx)(oe,{toggleModal:this.toggleModal,isOpen:this.state.modalOpen,setImage:this.setUnsplashImage,generateDefaultDimensions:this.generateDefaultDimensions})]})}}]),s}(n.Component)),ge=s(94),be=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={color:null,saveComplete:!1},e.handleOpened=function(){e.setState({saveComplete:!1})},e.handleDimensionsChange=function(t){e.props.setDimension(t.target.name,t.target.valueAsNumber)},e.handleDimensionsBlur=function(t){e.props.setDimension(t.target.name,e.validateDimension(t.target.value))},e.handleColorChange=function(t){var s=t.target.value;e.setState({color:s}),document.documentElement.style.setProperty("--puzzle-bg",s)},e.handleSave=Object(l.a)(c.a.mark((function t(){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({saveComplete:!1}),t.next=3,e.props.saveGame();case 3:s=t.sent,e.setState({saveComplete:s});case 5:case"end":return t.stop()}}),t)}))),e}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var e=document.documentElement.style.getPropertyValue("--puzzle-bg");this.setState({color:""!==e?e:"#adb5bd"})}},{key:"validateDimension",value:function(e){var t=parseInt(e,10);return isNaN(t)||t<this.props.minPuzzleDimension?t=this.props.minPuzzleDimension:t>this.props.maxPuzzleDimension&&(t=this.props.maxPuzzleDimension),t}},{key:"render",value:function(){var e=isNaN(this.props.rows)?"":this.props.rows,t=isNaN(this.props.cols)?"":this.props.cols;return Object(L.jsxs)(Y.a,{toggle:this.props.toggleModal,isOpen:this.props.isOpen,onOpened:this.handleOpened,centered:!0,children:[Object(L.jsx)(X.a,{toggle:this.props.toggleModal,children:"Settings"}),Object(L.jsx)(J.a,{children:Object(L.jsxs)("form",{className:"container",children:[Object(L.jsx)("div",{className:"row mb-2",children:Object(L.jsx)("span",{children:"Options"})}),Object(L.jsxs)("div",{className:"form-group row mb-4 pl-3",children:[Object(L.jsx)("label",{className:"col-form-label mr-2 my-2",htmlFor:"row-input",children:"Rows:"}),Object(L.jsx)("input",{className:"mr-2 my-2",id:"row-input",type:"number",min:this.props.minPuzzleDimension,max:this.props.maxPuzzleDimension,name:"rows",value:e,onChange:this.handleDimensionsChange,onBlur:this.handleDimensionsBlur}),Object(L.jsx)("label",{className:"col-form-label mr-2 my-2",htmlFor:"col-input",children:"Columns:"}),Object(L.jsx)("input",{className:"mr-2 my-2",id:"col-input",type:"number",min:this.props.minPuzzleDimension,max:this.props.maxPuzzleDimension,name:"cols",value:t,onChange:this.handleDimensionsChange,onBlur:this.handleDimensionsBlur}),Object(L.jsx)("small",{className:"col-12 col-sm pl-0 pl-sm-3 text-muted",children:"Changes to rows and columns take effect the next time you start a new puzzle."})]}),Object(L.jsxs)("div",{className:"form-group row mb-4 pl-3",children:[Object(L.jsx)("label",{className:"col-auto col-form-label pl-0",htmlFor:"color-input",children:"Background color:"}),Object(L.jsx)(ge.a,{className:"col",id:"color-input",type:"color",value:this.state.color,onChange:this.handleColorChange})]}),Object(L.jsx)("div",{className:"row mb-2",children:Object(L.jsx)("span",{className:"col-auto col-form-label pl-0",children:"Save"})}),Object(L.jsxs)("div",{className:"form-group row mb-4 px-3 align-items-center",children:[Object(L.jsx)("button",{className:"btn btn-dark col col-sm-auto mb-2 mb-sm-0",type:"button",onClick:this.handleSave,children:"Save now"}),Object(L.jsx)("small",{className:"col-12 col-sm pl-0 pl-sm-3 text-muted",children:"Data is saved locally in your browser. It will be deleted if you clear your browser's local storage for this site."}),this.state.saveComplete&&Object(L.jsxs)("small",{className:"col-12 text-success text-right",children:["Saved ",Object(L.jsx)("i",{className:"bi bi-check"})]})]}),Object(L.jsx)("div",{className:"form-group row mb-4 px-3 align-items-center",children:Object(L.jsx)("button",{className:"btn btn-outline-dark col col-sm-auto mb-2 mb-sm-0",type:"button",onClick:this.props.loadGame,children:"Load last saved puzzle"})}),Object(L.jsx)("div",{className:"form-group row justify-content-end",children:Object(L.jsx)("button",{className:"btn btn-dark btn-lg px-4",type:"button",onClick:this.props.toggleModal,children:"Done"})})]})})]})}}]),s}(n.Component),je=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={modalOpen:!1,selectedImage:de[0],rows:de[0].defaultRows,cols:de[0].defaultCols},e.toggleModal=function(){e.setState((function(e){return{modalOpen:!e.modalOpen}}))},e.setSelectedImage=function(t){if(t!==e.state.selectedImage){var s,n,a=null!==(s=null===t||void 0===t?void 0:t.defaultRows)&&void 0!==s?s:e.state.rows,r=null!==(n=null===t||void 0===t?void 0:t.defaultCols)&&void 0!==n?n:e.state.cols;e.setState({selectedImage:t,rows:a,cols:r})}},e.setDimension=function(t,s){e.setState(Object(f.a)({},t,s))},e.newPuzzle=function(){if(e.state.selectedImage){var t=e.state.selectedImage;document.documentElement.style.setProperty("--puzzle-img","url(".concat(t.url,")"));var s=new Image;s.onerror=function(){return console.log("Failed to load image")},s.onload=function(){return e.props.newPuzzle(s.naturalWidth,s.naturalHeight,e.state.rows,e.state.cols,t)},s.src=t.url}},e}return Object(u.a)(s,[{key:"componentDidMount",value:function(){this.newPuzzle()}},{key:"render",value:function(){return Object(L.jsxs)("div",{className:"container mt-4",children:[Object(L.jsx)("div",{className:"row mb-3",children:Object(L.jsx)(me,{setSelectedImage:this.setSelectedImage,minPuzzleDimension:2})}),Object(L.jsxs)("div",{className:"row justify-content-center align-items-end mx-n1",children:[Object(L.jsx)("div",{className:"col d-none d-md-block px-2"}),Object(L.jsx)("div",{className:"col-auto px-2",children:Object(L.jsx)("button",{className:"btn btn-dark btn-lg px-4",type:"button",onClick:this.newPuzzle,disabled:!this.state.selectedImage,children:"New puzzle"})}),Object(L.jsx)("div",{className:"col-auto col-md px-2",children:Object(L.jsxs)("button",{className:"btn btn-outline-dark",type:"button",onClick:this.toggleModal,children:[Object(L.jsx)("i",{className:"bi bi-gear-fill pr-2"}),"Settings"]})}),Object(L.jsx)(be,{toggleModal:this.toggleModal,saveGame:this.props.savePuzzle,loadGame:this.props.loadPuzzle,isOpen:this.state.modalOpen,rows:this.state.rows,cols:this.state.cols,setDimension:this.setDimension,minPuzzleDimension:2,maxPuzzleDimension:25})]})]})}}]),s}(n.Component),fe=function e(t,s,n,a,r,o){Object(h.a)(this,e),this.pieces=t,this.rows=s,this.cols=n,this.imageWidth=a,this.imageHeight=r,this.imageInfo=o},ve=s(95),Oe=s(96),xe=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"render",value:function(){var e=this.props.image,t="";if(e&&e.source){var s=(e.source.nameIsTitle?e.name:"Photo")+" by "+e.author;t=Object(L.jsxs)(J.a,{children:[Object(L.jsxs)(ve.a,{children:[Object(L.jsx)(Oe.a,{md:"8",children:Object(L.jsx)("img",{src:e.url,alt:"Thumbnail",width:"100%"})}),Object(L.jsxs)(Oe.a,{md:"4",className:"mt-3 mt-md-0 pl-md-0",children:[Object(L.jsx)("p",{children:s}),Object(L.jsxs)("p",{children:["Source: ",e.source.sourceName]})]})]}),Object(L.jsx)(ve.a,{className:"mt-md-3",children:Object(L.jsxs)(Oe.a,{children:[Object(L.jsxs)("p",{className:"text-break",children:["See the original at: ",Object(L.jsx)("a",{href:e.source.sourceUrl,target:"_blank",rel:"external noreferrer",children:e.source.sourceUrl})]}),e.source.description?Object(L.jsx)("p",{children:e.source.description}):null]})})]})}return Object(L.jsxs)(Y.a,{toggle:this.props.toggleModal,isOpen:this.props.isOpen,centered:!0,children:[Object(L.jsx)(X.a,{toggle:this.props.toggleModal,children:"Image details"}),t]})}}]),s}(n.Component),ye=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(h.a)(this,s),(n=t.call(this,e)).toggleModal=n.toggleModal.bind(Object(x.a)(n)),n.state={modalOpen:!1},n}return Object(u.a)(s,[{key:"toggleModal",value:function(){this.setState((function(e){return{modalOpen:!e.modalOpen}}))}},{key:"render",value:function(){var e=this.props.puzzleImage;if(!e)return null;var t=e.source&&e.source.isPhoto,s=e.source&&e.source.nameIsTitle,n=s?Object(L.jsx)("em",{children:e.name}):"",a="";e.author&&(a+=s?", ".concat(t?" photo":""," by "):t?"Photo by ":"By ",a+=e.author);var r=e.source?Object(L.jsx)("button",{type:"button",className:"btn btn-link btn-sm text-muted px-1",onClick:this.toggleModal,children:"more info"}):"";return Object(L.jsxs)("div",{className:"container-fluid container-md mt-3",children:[Object(L.jsxs)("div",{className:"row justify-content-center flex-sm-nowrap mx-n2",children:[Object(L.jsx)("div",{className:"col-2 d-none d-md-block px-2",children:" "}),Object(L.jsx)("div",{className:"col-auto flex-shrink-1 px-2",children:Object(L.jsxs)("p",{className:"h5",children:[n,a]})}),Object(L.jsx)("div",{className:"col-auto col-sm-2 px-2",children:r})]}),Object(L.jsx)(xe,{toggleModal:this.toggleModal,isOpen:this.state.modalOpen,image:e})]})}}]),s}(n.Component),we=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(h.a)(this,s);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).puzzle=Object(n.createRef)(),e.state={puzzleKey:1,image:{width:null,height:null,info:null},rows:null,cols:null,savedPieces:null,error:null},e.newPuzzle=function(t,s,n,a,r){var o=e.state,i=o.savedPieces,c=o.image;i&&"user"===c.info.type&&URL.revokeObjectURL(c.info.url),e.setState((function(e){return{puzzleKey:e.puzzleKey+1,image:{width:t,height:s,info:r},rows:n,cols:a,savedPieces:null}}))},e.saveUserImage=function(){var t=Object(l.a)(c.a.mark((function t(s){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(s).then((function(e){return e.blob()}));case 2:return n=t.sent,t.abrupt("return",new Promise((function(t){var s=new FileReader;s.onloadend=function(){if(s.result)try{localStorage.setItem("latestSaveImage",s.result),t(!0)}catch(n){e.setState({error:"Failed to save image; it may be too large to store in localStorage (limit: roughly 3.75MB)."}),console.log(n),t(!1)}else e.setState({error:"Failed to save image: can't read image."}),t(!1)},s.readAsDataURL(n)})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.savePuzzle=Object(l.a)(c.a.mark((function t(){var s,n,a,r,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e.puzzle.current.getGameState(),n=e.state,a=n.image,r=n.rows,o=n.cols,i=new fe(s,r,o,a.width,a.height,a.info),t.prev=3,localStorage.getItem("latestSaveImage")&&localStorage.removeItem("latestSaveImage"),localStorage.setItem("latestSave",JSON.stringify(i)),t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(3),e.setState({error:"Failed to save puzzle; localStorage may be full or unavailable (e.g. in a private browsing window)."}),console.log(t.t0),t.abrupt("return",!1);case 13:if("user"!==a.info.type){t.next=19;break}return t.next=16,e.saveUserImage(a.info.url);case 16:return t.abrupt("return",t.sent);case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,null,[[3,8]])}))),e.loadPuzzle=Object(l.a)(c.a.mark((function t(){var s,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"user"!==(s=JSON.parse(localStorage.getItem("latestSave"),(function(e,t){return"pieces"===e?t.map((function(e){return Object.assign(new j,e)})):t}))).imageInfo.type){t.next=7;break}return t.next=5,fetch(localStorage.getItem("latestSaveImage")).then((function(e){return e.blob()}));case 5:n=t.sent,s.imageInfo.url=URL.createObjectURL(n);case 7:t.next=14;break;case 9:return t.prev=9,t.t0=t.catch(0),e.setState({error:"Failed to load saved puzzle."}),console.log(t.t0),t.abrupt("return");case 14:e.setState((function(e){return{puzzleKey:e.puzzleKey+1,image:{width:s.imageWidth,height:s.imageHeight,info:s.imageInfo},rows:s.rows,cols:s.cols,savedPieces:s.pieces}}));case 15:case"end":return t.stop()}}),t,null,[[0,9]])}))),e.handleToastDismiss=function(){e.setState({error:null})},e}return Object(u.a)(s,[{key:"render",value:function(){var e=this.state,t=e.puzzleKey,s=e.image,n=e.rows,a=e.cols,r=e.savedPieces,o=e.error;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(je,{newPuzzle:this.newPuzzle,savePuzzle:this.savePuzzle,loadPuzzle:this.loadPuzzle}),s.info&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(ye,{puzzleImage:s.info}),Object(L.jsx)(V,{ref:this.puzzle,imgUrl:s.info.url,imgWidth:s.width,imgHeight:s.height,rows:n,cols:a,pieces:r},t)]}),Object(L.jsxs)(m.a,{isOpen:!!o,children:[Object(L.jsx)(g.a,{toggle:this.handleToastDismiss,children:"Error"}),Object(L.jsx)(b.a,{children:o})]})]})}}]),s}(n.Component),ke=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(){return Object(h.a)(this,s),t.apply(this,arguments)}return Object(u.a)(s,[{key:"render",value:function(){return Object(L.jsxs)(Y.a,{isOpen:this.props.isOpen,toggle:this.props.toggle,centered:!0,children:[Object(L.jsx)(X.a,{toggle:this.props.toggle,children:"Browser compatibility"}),Object(L.jsxs)(J.a,{children:[Object(L.jsxs)("p",{children:["For the best experience, it's recommended to view this website in a recent version of ",Object(L.jsx)("b",{children:"Firefox"}),", ",Object(L.jsx)("b",{children:"Chrome"}),", or ",Object(L.jsx)("b",{children:"Edge"})," on desktop,"," ","or ",Object(L.jsx)("b",{children:"Chrome"})," on mobile."]}),Object(L.jsxs)("p",{children:["Safari is mostly supported, but there is an issue where the clickable area of each puzzle piece extends past the visible image"," ","(due to the clip-path property not masking the mouse hit area)."]}),Object(L.jsx)("p",{children:"This site does not work in Internet Explorer."})]})]})}}]),s}(n.Component),Pe=function(e){Object(p.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(h.a)(this,s),(n=t.call(this,e)).toggleModal=n.toggleModal.bind(Object(x.a)(n)),n.state={modalOpen:!1},n}return Object(u.a)(s,[{key:"toggleModal",value:function(){this.setState({modalOpen:!this.state.modalOpen})}},{key:"render",value:function(){return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)("button",{className:"btn btn-link text-light",type:"button",onClick:this.toggleModal,children:[Object(L.jsx)("i",{className:"bi bi-list-check text-light mr-2"}),Object(L.jsx)("small",{className:"align-text-top",children:"Browser support"})]}),Object(L.jsx)(ke,{toggle:this.toggleModal,isOpen:this.state.modalOpen})]})}}]),s}(n.Component);s(86),s(87),s(88);o.a.render(Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(we,{})}),document.getElementById("react-root")),o.a.render(Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(Pe,{})}),document.getElementById("compatibility-info-root"))}},[[89,1,2]]]);
//# sourceMappingURL=main.fd4ad5db.chunk.js.map