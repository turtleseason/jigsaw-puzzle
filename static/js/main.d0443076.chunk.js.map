{"version":3,"sources":["util.js","Edges.js","Sides.js","EdgePathDrawer.js","EdgeStyleInfo.js","Piece.js","PieceModel.js","PuzzleCompleteImage.js","Puzzle.js","DetailsModal.js","PuzzleTitle.js","ImageInfo.js","images/ito-jakuchu-red-parrot-on-the-branch-of-a-tree.jpg","images/david-clode-eOSqRq2Qm1c-unsplash.jpg","images/casey-horner-80UR4DM2Rz0-unsplash.jpg","images/van-gogh-roses-nga.jpg","images/scott-webb-lYzgtps0UtQ-unsplash.jpg","images/travel-sourced-FsmcD6uKcHk-unsplash.jpg","providedImages.js","PuzzleControls.js","index.js"],"names":["range","i","Array","from","keys","randomInt","max","Math","floor","random","BUMP","RECESS","FLAT","getRandomEdgeType","types","length","LEFT","TOP","RIGHT","BOTTOM","Sides","Symbol","iterator","EdgePathDrawer","pieceWidth","pieceHeight","borderSize","this","START","templates","makeTemplates","pW","pH","b","w","o","c1","c2","side","edgeStyleInfo","start","end","mid","type","key","EdgeStyleInfo","neckWidth","offset","control1","control2","other","edge","Error","getOppositeEdge","Piece","props","bgPos","model","backgroundPositionString","left","top","clipPathString","getClipPathString","edgeDrawer","getPathString","edges","className","blockPointerEvents","tempid","onPointerDown","e","style","backgroundPosition","clipPath","width","height","pos","zIndex","PureComponent","PieceModel","col","row","neighbors","group","PuzzleCompleteImage","state","startPos","requestAnimationFrame","setState","destPos","onTransitionEnd","Component","Puzzle","innerWidth","imgWidth","cols","innerHeight","imgHeight","rows","min","pointerDownHandlers","map","handlePointerDown","bind","handlePointerMove","handlePointerUp","handleTransitionEnd","nextzIndex","pieces","createPieces","groups","keyToValueFunc","obj","objectMap","gameComplete","draggedPiece","setScaleFactor","resizeListener","window","addEventListener","removeEventListener","widthScale","document","documentElement","clientWidth","heightScale","clientHeight","scaleFactor","spacing","availableKeys","keysByGridPos","fill","keyIndex","splice","getRandomPosition","getBackgroundPosition","createEdge","opposite","topLeftKey","piece","alignWith","snapRange","abs","g1","g2","concat","refPiece","k","p","alignPiece","isPrimary","pointerType","button","slice","offsetX","clientX","offsetY","clientY","hitElement","elementFromPoint","classList","contains","neighbor","isTouching","mergeGroups","Object","endAnimationComplete","bg","querySelector","board","boardStyle","transform","getTopLeftPos","getCenteredImagePos","children","renderPiece","onPointerMove","onPointerUp","DetailsModal","image","body","source","credit","nameIsTitle","name","author","ModalBody","Row","Col","md","src","url","sourceName","class","href","sourceUrl","target","rel","description","Modal","toggle","toggleModal","isOpen","centered","ModalHeader","PuzzleTitle","modalOpen","puzzleImage","isPhoto","title","info","onClick","ImageInfo","defaultRows","defaultCols","shortName","ImageSource","providedImages","img1","img2","img3","img4","img5","img6","PuzzleControls","fileInput","React","createRef","selectedPreset","presetImages","userImage","handleSelectChange","handleFileChange","handleDimensionsChange","handleDimensionsBlur","handleRadioKeyDown","useUserImage","usePresetImage","newPuzzle","usingUserImage","invalidUserImage","id","getElementById","focus","preventDefault","select","selectedIndex","img","file","current","files","fileUrl","URL","createObjectURL","testLoader","Image","onerror","revokeObjectURL","onload","dim","generateDefaultDimensions","naturalWidth","naturalHeight","aspect","x","clamp","round","valueAsNumber","validateDimension","value","val","result","parseInt","isNaN","selectedImage","setProperty","sizeTester","console","log","options","push","rowsVal","colsVal","presetBtnStyle","userBtnStyle","readOnly","checked","onKeyDown","htmlFor","onChange","renderSelectOptions","CustomInput","accept","innerRef","invalid","onBlur","disabled","puzzleKey","ReactDOM","render","StrictMode","renderPuzzle","columns"],"mappings":"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","file":"static/js/main.d0443076.chunk.js","sourcesContent":["// Returns an array containing int values from 0 (inclusive) to i (exclusive).\r\nexport function range(i) {\r\n    return Array.from(Array(i).keys());\r\n}\r\n\r\n// Returns a random integer between 0 (inclusive) and max (exclusive).\r\nexport function randomInt(max) {\r\n    return Math.floor(Math.random() * Math.floor(max));\r\n}\r\n\r\n// Restricts x to the range between min and max (inclusive).\r\nexport function clamp(x, min, max) {\r\n    if (min > max) {\r\n        throw Error(`clamp: min (${min}) is greater than max (${max}).`);\r\n    }\r\n    return Math.max(Math.min(x, max), min);\r\n}\r\n\r\n// Creates an object where the \"keys\" iterable provides the keys\r\n// and each value is the result of passing its corresponding key to keyToValueFunc.\r\nexport function objectMap(keys, keyToValueFunc) {\r\n    const obj = {};\r\n    for (const i of keys) {\r\n        obj[i] = keyToValueFunc(i);\r\n    }\r\n    return obj;\r\n}","import { randomInt } from './util';\r\n\r\n\r\nexport const BUMP = 'b';\r\nexport const RECESS = 'r';\r\nexport const FLAT = 'f';\r\n\r\n// Excludes FLAT since that edge type isn't assigned randomly.\r\nexport function getRandomEdgeType() {\r\n\tconst types = [BUMP, RECESS];\r\n\treturn types[randomInt(types.length)];\r\n}\r\n\r\nexport function getOppositeEdge(edge) {\r\n\tswitch(edge) {\r\n\t\tcase BUMP:\r\n\t\t\treturn RECESS;\r\n\t\tcase RECESS:\r\n\t\t\treturn BUMP;\r\n\t\tdefault:\r\n\t\t\tthrow Error(`getOppositeEdge: ${edge} does not have an opposite edge type`);\r\n\t}\r\n}","export const LEFT = 'Left';\r\nexport const TOP = 'Top';\r\nexport const RIGHT = 'Right';\r\nexport const BOTTOM = 'Bottom';\r\n\r\n// Use this to iterate through all four sides in a consistent order.\r\nexport const Sides = {\r\n    *[Symbol.iterator]() {\r\n        yield LEFT;\r\n        yield TOP;\r\n        yield RIGHT;\r\n        yield BOTTOM;\r\n    }\r\n}","import { BUMP, RECESS, FLAT } from './Edges';\r\nimport { LEFT, TOP, RIGHT, BOTTOM } from './Sides';\r\n\r\n\r\nexport default class EdgePathDrawer {\r\n\tconstructor(pieceWidth, pieceHeight, borderSize) {\r\n\t\tthis.START = 'START';\r\n\t\tthis.templates = this.makeTemplates(pieceWidth, pieceHeight, borderSize)\r\n\t}\r\n\r\n\tmakeTemplates(pW, pH, b) {\r\n\t\tconst templates = {};\r\n\r\n\t\ttemplates[this.START] = `M ${b} ${pH - b} `;\r\n\r\n\t\ttemplates[BUMP + LEFT] = (w, o, c1, c2) => `V ${(pH + w) / 2}`\t\r\n\t\t\t+ `C ${b - o} ${pH / 2 + c1} ${0} ${pH / 2 + c2} ${0} ${pH / 2} `\r\n\t\t\t+ `C ${0} ${pH / 2 - c2} ${b - o} ${pH / 2 - c1} ${b} ${(pH - w) / 2} `;\r\n\t\ttemplates[RECESS + LEFT] = (w, o, c1, c2) => `V ${(pH + w) / 2}`\r\n\t\t\t+ `C ${b + o} ${pH / 2 + c1} ${b * 2} ${pH / 2 + c2} ${b * 2} ${pH / 2} `\r\n\t\t\t+ `C ${b * 2} ${pH / 2 - c2} ${b + o} ${pH / 2 - c1} ${b} ${(pH - w) / 2} `;\r\n\t\ttemplates[LEFT] = `V ${b} `;\r\n\r\n\t\ttemplates[BUMP + TOP] = (w, o, c1, c2) => `H ${(pW - w) / 2} `\r\n\t\t\t+ `C ${pW / 2 - c1} ${b - o} ${pW / 2 - c2} ${0} ${pW / 2} ${0} `\r\n\t\t\t+ `C ${pW / 2 + c2} ${0} ${pW / 2 + c1} ${b - o} ${(pW + w) / 2} ${b} `;\r\n\t\ttemplates[RECESS + TOP] = (w, o, c1, c2) => `H ${(pW - w) / 2} `\r\n\t\t\t+ `C ${pW / 2 - c1} ${b + o}  ${pW / 2 - c2} ${b * 2} ${pW / 2} ${b * 2} `\r\n\t\t\t+ `C ${pW / 2 + c2} ${b * 2} ${pW / 2 + c1} ${b + o} ${(pW + w) / 2} ${b} `;\r\n\t\ttemplates[TOP] = `H ${pW - b} `;\r\n\r\n\t\ttemplates[BUMP + RIGHT] = (w, o, c1, c2) => `V ${(pH - w) / 2} `\r\n\t\t\t+ `C ${pW - b + o} ${pH / 2 - c1} ${pW} ${pH / 2 - c2} ${pW} ${pH / 2} `\r\n\t\t\t+ `C ${pW} ${pH / 2 + c2} ${pW - b + o} ${pH / 2 + c1} ${pW - b} ${(pH + w) / 2} `;\r\n\t\ttemplates[RECESS + RIGHT] = (w, o, c1, c2) => `V ${(pH - w) / 2} `\r\n\t\t\t+ `C ${pW - b - o} ${pH / 2 - c1} ${pW - b * 2} ${pH / 2 - c2} ${pW - b * 2} ${pH / 2} `\r\n\t\t\t+ `C ${pW - b * 2} ${pH / 2 + c2} ${pW - b - o} ${pH / 2 + c1} ${pW - b} ${(pH + w) / 2} `;\r\n\t\ttemplates[RIGHT] = `V ${pH - b} `;\r\n\r\n\t\ttemplates[BUMP + BOTTOM] = (w, o, c1, c2) => `H ${(pW + w) / 2} `\r\n\t\t\t+ `C ${pW / 2 + c1} ${pH - b + o} ${pW / 2 + c2} ${pH} ${pW / 2} ${pH} `\r\n\t\t\t+ `C ${pW / 2 - c2} ${pH} ${pW / 2 - c1} ${pH - b + o} ${(pW - w) / 2} ${pH - b} `;\r\n\t\ttemplates[RECESS + BOTTOM] = (w, o, c1, c2) => `H ${(pW + w) / 2} `\r\n\t\t\t+ `C ${pW / 2 + c1} ${pH - b - o}  ${pW / 2 + c2} ${pH - b * 2} ${pW / 2} ${pH - b * 2} `\r\n\t\t\t+ `C ${pW / 2 - c2} ${pH - b * 2} ${pW / 2 - c1} ${pH - b - o} ${(pW - w) / 2} ${pH - b} `;\r\n\t\ttemplates[BOTTOM] = `Z`;\r\n\r\n\t\treturn templates;\r\n\t}\r\n\r\n\tgetPathString(side, edgeStyleInfo) {\r\n\t\tconst start = (side === LEFT) ? this.templates[this.START] : '';\r\n\t\tconst end = this.templates[side];\r\n\r\n\t\tlet mid = '';\r\n\t\tif (edgeStyleInfo.type !== FLAT) {\r\n\t\t\tconst key = edgeStyleInfo.type + side;\r\n\t\t\tmid = this.templates[key](edgeStyleInfo.w, edgeStyleInfo.o, edgeStyleInfo.c1, edgeStyleInfo.c2);\r\n\t\t}\r\n\r\n\t\treturn start + mid + end;\r\n\t}\r\n}","import { getOppositeEdge } from './Edges';\r\n\r\n\r\n// Contains the properties needed to draw a specific puzzle piece edge:\r\n// its overall type (bump, recess, flat) and any constants needed to define its shape.\r\nexport default class EdgeStyleInfo {\r\n\tconstructor(type, neckWidth, offset, control1, control2) {\r\n\t\tthis.type = type;\r\n\t\tthis.w = neckWidth;\t\t// The width of the area where the bump meets the edge of the piece.\r\n\t\tthis.o = offset;\t\t// Controls the distance between the widest part of the bump and the edge of the piece.\r\n\t\tthis.c1 = control1;\t\t// Controls the width of the widest part of the bump.\r\n\t\tthis.c2 = control2;\t\t// Controls the width near the tallest part of the bump (affects the smoothness/pointiness of the curve).\r\n\t}\r\n\r\n    // Returns an EdgeStyleInfo object for an edge that fits with this one:\r\n    // if this is a bump edge, opposite() returns a matching recess edge, and vice-versa.\r\n    // Will fail if called on a flat edge.\r\n\topposite() {\r\n\t\tconst other = {...this};\r\n\t\tother.type = getOppositeEdge(this.type);\r\n\t\treturn other;\r\n\t}\r\n}","import { PureComponent } from 'react';\r\nimport { Sides } from './Sides';\r\n\r\n\r\nexport default class Piece extends PureComponent {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tconst bgPos = this.props.model.bgPos;\r\n\t\t// These will never change over the lifetime of the object, so just calculate them once\r\n\t\tthis.backgroundPositionString = `${bgPos.left}px ${bgPos.top}px`;\r\n\t\tthis.clipPathString = this.getClipPathString(this.props.edgeDrawer);\r\n\t}\r\n\t\r\n\tgetClipPathString(edgeDrawer) {\r\n\t\tlet clipPathString = 'path(\\'';\r\n\t\tfor (const side of Sides) {\r\n\t\t\tclipPathString += edgeDrawer.getPathString(side, this.props.model.edges[side]);\r\n\t\t}\r\n\t\treturn clipPathString + '\\')';\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst model = this.props.model;\r\n\t\tconst className = 'puzzle-piece' + (this.props.blockPointerEvents ? ' block-pointer-events' : '');\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tclassName={className}\r\n\t\t\t\ttempid={model.key}\r\n\t\t\t\tonPointerDown={(e) => this.props.onPointerDown(e)}\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tbackgroundPosition: this.backgroundPositionString,\r\n\t\t\t\t\tclipPath: this.clipPathString,\r\n\t\t\t\t\twidth: this.props.width,\r\n\t\t\t\t\theight: this.props.height,\r\n\t\t\t\t\tleft: model.pos.left,\r\n\t\t\t\t\ttop: model.pos.top,\r\n\t\t\t\t\tzIndex: (model.zIndex > 0 ? model.zIndex : 'auto')\r\n\t\t\t\t}}>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","export default class PieceModel {\r\n\t// By default, a new piece is inserted into the group with the same id as its key\r\n\tconstructor(key, col, row, pos, bgPos, zIndex, edges, neighbors) {\r\n\t\tthis.key = key;\r\n\t\tthis.group = key;\r\n\t\tthis.col = col;\r\n\t\tthis.row = row;\r\n\t\tthis.pos = pos;\r\n\t\tthis.bgPos = bgPos;\r\n\t\tthis.zIndex = zIndex;\r\n\t\tthis.edges = edges;\r\n\t\tthis.neighbors = neighbors;\r\n\t}\r\n}","import { Component } from 'react';\r\n\r\nexport default class PuzzleCompleteImage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {...this.props.startPos};\r\n    }\r\n\r\n    componentDidMount() {\r\n        requestAnimationFrame(() => this.setState({...this.props.destPos}));\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='puzzle-complete-img' onTransitionEnd={this.props.onTransitionEnd} \r\n                style={{width: this.props.width, height: this.props.height, left: this.state.left, top: this.state.top}}>\r\n            </div>\r\n        ); \r\n    }\r\n}","import { Component } from 'react';\r\nimport EdgePathDrawer from './EdgePathDrawer';\r\nimport EdgeStyleInfo from './EdgeStyleInfo';\r\nimport Piece from './Piece';\r\nimport PieceModel from './PieceModel';\r\nimport PuzzleCompleteImage from './PuzzleCompleteImage';\r\n\r\nimport { getRandomEdgeType, getOppositeEdge } from './Edges';\r\nimport { BUMP, RECESS, FLAT } from './Edges';\r\nimport { LEFT, TOP, RIGHT, BOTTOM, Sides } from './Sides';\r\nimport { range, randomInt, objectMap } from './util';\r\n\r\nimport './Puzzle.css';\r\n\r\n\r\nconst MAX_WIDTH_SCALE = .7;  // The maximum percentage of the window width that the puzzle image should take up. \r\nconst MAX_HEIGHT_SCALE = .7;  // The maximum percentage of the window height that the puzzle image should take up. \r\n\r\nexport default class Puzzle extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.innerWidth =  this.props.imgWidth / this.props.cols;\t\r\n\t\tthis.innerHeight = this.props.imgHeight / this.props.rows;\r\n\t\tthis.borderSize = Math.min(this.innerHeight, this.innerWidth) / 4;\r\n\t\tthis.pieceWidth = 2 * this.borderSize + this.innerWidth;\r\n\t\tthis.pieceHeight = 2 * this.borderSize + this.innerHeight;\r\n\r\n\t\tthis.pointerDownHandlers = range(this.props.rows * this.props.cols).map(i => this.handlePointerDown.bind(this, i));\r\n\t\tthis.handlePointerMove = this.handlePointerMove.bind(this);\r\n\t\tthis.handlePointerUp = this.handlePointerUp.bind(this);\r\n\t\tthis.handleTransitionEnd = this.handleTransitionEnd.bind(this);\r\n\r\n\t\tthis.edgeDrawer = new EdgePathDrawer(this.pieceWidth, this.pieceHeight, this.borderSize);\r\n\t\tthis.nextzIndex = 1;\r\n\r\n\t\tconst pieces = this.createPieces();\r\n\t\tconst groups = objectMap(range(pieces.length), (i) => [i]);\r\n\r\n\t\tthis.state = {\r\n\t\t\tpieces: pieces,\r\n\t\t\tgroups: groups,\r\n\t\t\tgameComplete: false,\r\n\t\t\tdraggedPiece: null,\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setScaleFactor();\r\n\r\n\t\tthis.resizeListener = this.setScaleFactor.bind(this);\r\n\t\twindow.addEventListener('resize', this.resizeListener);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\twindow.removeEventListener('resize', this.resizeListener);\r\n\t}\r\n\r\n\tsetScaleFactor() {\r\n\t\tconst widthScale = MAX_WIDTH_SCALE * document.documentElement.clientWidth / this.props.imgWidth;\r\n\t\tconst heightScale = MAX_HEIGHT_SCALE * document.documentElement.clientHeight / this.props.imgHeight;\r\n\t\tthis.setState({scaleFactor: Math.min(widthScale, heightScale)});\r\n\t}\r\n\r\n\tgetGridPosition(col, row, spacing) {\r\n\t\tconst left = (this.innerWidth + spacing) * col - this.borderSize;\r\n\t\tconst top = (this.innerHeight + spacing) * row - this.borderSize;\r\n\t\treturn {left: left, top: top};\r\n\t}\r\n\t\r\n\tgetRandomPosition() {\r\n\t\tconst left = Math.random() * (.2 * this.props.imgWidth);\r\n\t\tconst top = Math.random() * (this.props.imgHeight - this.pieceHeight);\r\n\t\treturn {left: left, top: top};\r\n\t}\r\n\t\r\n\tgetBackgroundPosition(col, row) {\r\n\t\tconst left = - (this.innerWidth * col) + this.borderSize;\r\n\t\tconst top = -(this.innerHeight * row) + this.borderSize;\r\n\t\treturn {left: left, top: top};\r\n\t}\r\n\t\r\n\tcreateEdge(type) {\r\n\t\tconst neckWidth = this.borderSize * (.8 + Math.random() * .45);\r\n\t\tconst offset = this.borderSize * (.4 + Math.random() * .1);\r\n\t\tconst c1 = (neckWidth > this.borderSize) ? neckWidth * (.75 + Math.random() * .25)\r\n\t\t\t\t\t: this.borderSize * (.85 + Math.random() * .35);\r\n\t\tconst c2 = neckWidth * (.5 + Math.random() * .15);\r\n\t\treturn new EdgeStyleInfo(type, neckWidth, offset, c1, c2);\r\n\t}\r\n\r\n\tcreatePieces() {\r\n\t\tconst pieces = [];\r\n\t\tconst availableKeys = range(this.props.cols * this.props.rows);\r\n\t\t// Use map() instead of fill() to ensure that each inner array is a unique object.\r\n\t\tconst keysByGridPos = Array(this.props.cols).fill(null).map(() => Array(this.props.rows));\r\n\t\t\r\n\t\tfor (let col = 0; col < this.props.cols; col++) {\r\n\t\t\tfor (let row = 0; row < this.props.rows; row++) {\r\n\t\t\t\tconst keyIndex = randomInt(availableKeys.length);\r\n\t\t\t\tconst key = availableKeys.splice(keyIndex, 1)[0];\r\n\t\t\t\tkeysByGridPos[col][row] = key;\r\n\t\t\t\t\r\n\t\t\t\t// const pos = this.getGridPosition(col, row, 0);\r\n\t\t\t\tconst pos = this.getRandomPosition();\r\n\t\t\t\tconst bgPos = this.getBackgroundPosition(col, row);\r\n\r\n\t\t\t\tconst neighbors = {};\r\n\t\t\t\tif (col > 0) {\r\n\t\t\t\t\tneighbors[LEFT] = keysByGridPos[col - 1][row];\r\n\t\t\t\t\tpieces[neighbors[LEFT]].neighbors[RIGHT] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (row > 0) {\r\n\t\t\t\t\tneighbors[TOP] = keysByGridPos[col][row - 1];\r\n\t\t\t\t\tpieces[neighbors[TOP]].neighbors[BOTTOM] = key;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst edges = {};\r\n\t\t\t\tedges[LEFT] = (col === 0) ? this.createEdge(FLAT) : pieces[neighbors[LEFT]].edges[RIGHT].opposite();\r\n\t\t\t\tedges[TOP] = (row === 0) ? this.createEdge(FLAT) : pieces[neighbors[TOP]].edges[BOTTOM].opposite();\r\n\t\t\t\tedges[RIGHT] = (col === this.props.cols - 1) ? this.createEdge(FLAT) : this.createEdge(getRandomEdgeType());\r\n\t\t\t\tedges[BOTTOM] = (row === this.props.rows - 1) ? this.createEdge(FLAT) : this.createEdge(getRandomEdgeType());\r\n\t\t\t\t\r\n\t\t\t\tpieces[key] = new PieceModel(key, col, row, pos, bgPos, 0, edges, neighbors);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.topLeftKey = keysByGridPos[0][0];\r\n\t\treturn pieces;\r\n\t}\r\n\r\n\talignPiece(piece, alignWith) {\r\n\t\tpiece.pos = {left: alignWith.pos.left + this.innerWidth * (piece.col - alignWith.col),\r\n\t\t\t\t\t top: alignWith.pos.top + this.innerHeight * (piece.row - alignWith.row)};\r\n\t}\r\n\t\r\n\tisTouching(piece, side, other) {\r\n\t\tconst snapRange = 7 / this.state.scaleFactor;\r\n\t\tif (side === RIGHT) {\r\n\t\t\treturn Math.abs(piece.pos.top - other.pos.top) <= snapRange\r\n\t\t\t\t&& Math.abs((other.pos.left - piece.pos.left) - this.innerWidth) <= snapRange;\r\n\t\t} else if (side === LEFT) {\r\n\t\t\treturn Math.abs(piece.pos.top - other.pos.top) <= snapRange\r\n\t\t\t\t&& Math.abs((piece.pos.left - other.pos.left) - this.innerWidth) <= snapRange;\r\n\t\t} else if (side === TOP) {\r\n\t\t\treturn Math.abs(piece.pos.left - other.pos.left) <= snapRange\r\n\t\t\t\t&& Math.abs((piece.pos.top - other.pos.top) - this.innerHeight) <= snapRange;\r\n\t\t} else if (side === BOTTOM) {\r\n\t\t\treturn Math.abs(piece.pos.left - other.pos.left) <= snapRange\r\n\t\t\t\t&& Math.abs((other.pos.top - piece.pos.top) - this.innerHeight) <= snapRange;\r\n\t\t}\r\n\t}\r\n\r\n\tmergeGroups(pieces, groups, g1, g2) {\r\n\t\tgroups[g1] = groups[g1].concat(groups[g2]);\r\n\t\tconst refPiece = pieces[groups[g1][0]];\r\n\t\tfor (const k of groups[g2]) {\r\n\t\t\tconst p = {...pieces[k]};\r\n\t\t\tp.group = g1;\r\n\t\t\tp.zIndex = refPiece.zIndex;\r\n\t\t\tthis.alignPiece(p, refPiece);\r\n\t\t\tpieces[k] = p;\r\n\t\t}\r\n\t\tdelete groups[g2];\r\n\t}\r\n\r\n\thandlePointerDown(key, e) {\r\n\t\tif (this.state.draggedPiece !== null || !e.isPrimary || (e.pointerType === 'mouse' && e.button !== 0)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst pieces = this.state.pieces.slice();\r\n\t\tfor (const k of this.state.groups[pieces[key].group]) {\r\n\t\t\tpieces[k] = {...pieces[k]};\r\n\t\t\tpieces[k].zIndex = this.nextzIndex;\r\n\t\t}\r\n\t\tthis.nextzIndex++;\r\n\r\n\t\tthis.setState({\r\n\t\t\tpieces: pieces,\r\n\t\t\tdraggedPiece: key,\r\n\t\t\toffsetX: e.clientX - (this.state.pieces[key].pos.left * this.state.scaleFactor),\r\n\t\t\toffsetY: e.clientY - (this.state.pieces[key].pos.top * this.state.scaleFactor)\r\n\t\t});\r\n\r\n\t}\r\n\r\n\thandlePointerMove(e) {\r\n\t\tif (this.state.draggedPiece === null || !e.isPrimary) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// Ignore events from touches that started within puzzle area but moved out of bounds\r\n\t\tconst hitElement = document.elementFromPoint(e.clientX, e.clientY);\r\n\t\tif (!hitElement || !hitElement.classList.contains('puzzle-area')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst key = this.state.draggedPiece;\r\n\t\tconst pieces = this.state.pieces.slice();\r\n\t\t\r\n\t\tconst p = {...pieces[key]};\r\n\t\tpieces[key] = p;\r\n\t\t\r\n\t\tconst left = (e.clientX - this.state.offsetX) / this.state.scaleFactor;\r\n\t\tconst top = (e.clientY - this.state.offsetY) / this.state.scaleFactor;\r\n\t\tp.pos = {left: left, top: top };\r\n\r\n\t\tfor (const k of this.state.groups[p.group]) {\r\n\t\t\tpieces[k] = {...pieces[k]};\r\n\t\t\tthis.alignPiece(pieces[k], p);\r\n\t\t}\r\n\t\tthis.setState({pieces: pieces});\r\n\t}\r\n\r\n\thandlePointerUp() {\r\n\t\tif (this.state.draggedPiece === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst key = this.state.draggedPiece;\r\n\t\tconst groups = {...this.state.groups};\r\n\t\tconst pieces = this.state.pieces.slice();\r\n\r\n\t\tfor (const k of this.state.groups[pieces[key].group]) {\r\n\t\t\tconst p = pieces[k];\r\n\t\t\tfor (const side of Sides) {\r\n\t\t\t\tconst neighbor = pieces[p.neighbors[side]];\r\n\t\t\t\tif (neighbor && neighbor.group !== p.group && this.isTouching(p, side, neighbor)) {\r\n\t\t\t\t\tthis.mergeGroups(pieces, groups, p.group, neighbor.group);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst gameComplete = Object.keys(groups).length === 1;\r\n\t\tthis.setState({groups: groups, pieces: pieces, draggedPiece: null, gameComplete: gameComplete});\r\n\t}\r\n\r\n\thandleTransitionEnd() {\r\n\t\tthis.setState({endAnimationComplete: true});\r\n\t}\r\n\r\n\tgetTopLeftPos() {\r\n\t\tconst pos = this.state.pieces[this.topLeftKey].pos;\r\n\t\treturn {left: pos.left + this.borderSize, top: pos.top + this.borderSize};\r\n\t}\r\n\r\n\tgetCenteredImagePos() {\r\n\t\tconst bg = document.querySelector('.puzzle-background');\r\n\t\tconst destLeft = (bg.clientWidth / this.state.scaleFactor - this.props.imgWidth) / 2;\r\n\t\tconst destTop = (bg.clientHeight / this.state.scaleFactor - this.props.imgHeight) / 2;\r\n\t\treturn {left: destLeft, top: destTop};\r\n\t}\r\n\r\n\trenderPiece(model) {\r\n\t\treturn (\r\n\t\t\t<Piece key={model.key}\r\n\t\t\t\tmodel={model}\r\n\t\t\t\twidth={this.pieceWidth}\r\n\t\t\t\theight={this.pieceHeight}\r\n\t\t\t\t// isDragged={model.group === this.state.pieces[this.state.draggedPiece].group}\r\n\t\t\t\tblockPointerEvents={this.state.draggedPiece !== null}\r\n\t\t\t\tedgeDrawer={this.edgeDrawer}\r\n\t\t\t\tonPointerDown={this.pointerDownHandlers[model.key]}/>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst boardStyle = {transform: `scale(${this.state.scaleFactor})`, width: (100 / this.state.scaleFactor) + '%', height: (100 / this.state.scaleFactor) + '%'};\r\n\r\n\t\tlet board;\r\n\t\tif (this.state.gameComplete && this.state.endAnimationComplete) {\r\n\t\t\tboard = (<div className='puzzle-area puzzle-complete' style={boardStyle}></div>);\r\n\t\t} else if (this.state.gameComplete) {\r\n\t\t\tboard = (\r\n\t\t\t\t<div className='puzzle-area' style={boardStyle}>\r\n\t\t\t\t\t<PuzzleCompleteImage startPos={this.getTopLeftPos()} destPos={this.getCenteredImagePos()}\r\n\t\t\t\t\twidth={this.props.imgWidth} height={this.props.imgHeight} onTransitionEnd={this.handleTransitionEnd}/>\r\n\t\t\t\t</div>);\r\n\t\t} else {\r\n\t\t\tconst children = this.state.pieces.map(model => this.renderPiece(model));\r\n\t\t\tboard = (\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName={'puzzle-area' + (this.state.draggedPiece !== null ? ' no-scroll' : '')}\r\n\t\t\t\t\tonPointerMove={this.handlePointerMove}\r\n\t\t\t\t\tonPointerUp={this.handlePointerUp}\r\n\t\t\t\t\tstyle={boardStyle}>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</div>);\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className='puzzle-container mt-2'>\r\n\t\t\t\t<div className='puzzle-background'></div>\r\n\t\t\t\t{board}\r\n\t\t\t\t{/* Use a separate div for padding because adding padding directly to the puzzle container\r\n\t\t\t\t    can cause the game-completed image to jump at the end of its motion */}\r\n\t\t\t\t<div className='pb-3'></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import { Component } from 'react';\r\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\r\nimport { Container, Row, Col } from 'reactstrap';\r\n\r\n\r\nexport default class DetailsModal extends Component {\r\n    render() {\r\n        const image = this.props.image;\r\n        \r\n        let body = '';\r\n        if (image && image.source) {\r\n                const credit = (image.source.nameIsTitle ? image.name : 'Photo') + ' by ' + image.author;\r\n                body = ( \r\n                    <ModalBody>\r\n                        <Row>\r\n                            <Col md='8'><img src={image.url} width='100%'/></Col>\r\n                            <Col md='4' className='mt-3 mt-md-0 pl-md-0'>\r\n                                <p>{credit}</p>\r\n                                <p>Source: {image.source.sourceName}</p>\r\n                            </Col>\r\n                        </Row>\r\n                        <Row className='mt-md-3'>\r\n                            <Col>\r\n                                <p class=\"text-break\">\r\n                                    See the original at: <a href={image.source.sourceUrl} target='_blank' rel='external noopener'>{image.source.sourceUrl}</a>\r\n                                </p>\r\n                                {image.source.description ? <p>{image.source.description}</p> : null}\r\n                            </Col>\r\n                        </Row>\r\n                    </ModalBody>\r\n                ); \r\n            }\r\n\r\n        return(\r\n            <Modal toggle={this.props.toggleModal} isOpen={this.props.isOpen} centered={true}> \r\n                <ModalHeader toggle={this.props.toggleModal}>Image details</ModalHeader>\r\n                {body}\r\n            </Modal>\r\n        );  \r\n    }\r\n}","import { Component } from 'react';\r\nimport DetailsModal from './DetailsModal';\r\n\r\n\r\nexport default class PuzzleTitle extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.toggleModal = this.toggleModal.bind(this);\r\n        this.state = {modalOpen: false};\r\n    }\r\n\r\n    toggleModal() {\r\n        this.setState((state) => { return {modalOpen: !state.modalOpen} });\r\n    }\r\n\r\n    render() {\r\n        const puzzleImage = this.props.puzzleImage;\r\n        if (!puzzleImage) {\r\n            return null;\r\n        }\r\n\r\n        const isPhoto = puzzleImage.source && puzzleImage.source.isPhoto;\r\n        const nameIsTitle = puzzleImage.source && puzzleImage.source.nameIsTitle;\r\n\r\n        const title = nameIsTitle ? <em>{puzzleImage.name}</em> : '';\r\n        let author = '';\r\n        if (puzzleImage.author) {\r\n            if (nameIsTitle) {\r\n                author += `, ${isPhoto ? ' photo' : ''} by `;\r\n            } else if (isPhoto) {\r\n                author += 'Photo by ';\r\n            } else {\r\n                author += 'By '\r\n            }\r\n            author += puzzleImage.author;\r\n        }\r\n        const info = puzzleImage.source ? <button type='button' className='btn btn-link btn-sm text-muted px-1' onClick={this.toggleModal}>more info</button> : '';\r\n\r\n        return (\r\n            <div className='container-fluid container-md mt-3'>\r\n                <div className='row justify-content-center flex-sm-nowrap mx-n2'>\r\n                    <div className='col-2 d-none d-md-block px-2'> </div> \r\n                    <div className='col-auto flex-shrink-1 px-2'>\r\n                        <p className='h5'>{title}{author}</p>\r\n                    </div>\r\n                    <div className='col-auto col-sm-2 px-2'>{info}</div>\r\n                </div>\r\n                <DetailsModal toggleModal={this.toggleModal} isOpen={this.state.modalOpen} image={puzzleImage} />\r\n            </div>);\r\n    }\r\n}","export class ImageInfo {\r\n    constructor(name, url, defaultRows, defaultCols, author, source, shortName) {\r\n        this.name = name;\r\n        this.url = url;\r\n        this.defaultRows = defaultRows;\r\n        this.defaultCols = defaultCols;\r\n        this.author = author;\r\n        this.source = source;\r\n        this.shortName = shortName ?? name;\r\n    }\r\n}\r\n\r\nexport class ImageSource {\r\n    constructor(sourceName, nameIsTitle=false, isPhoto=false, sourceUrl='', description='') {\r\n        this.sourceName = sourceName;\r\n        this.nameIsTitle = nameIsTitle;\r\n        this.sourceUrl = sourceUrl;\r\n        this.isPhoto = isPhoto;\r\n        this.description = description;\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/ito-jakuchu-red-parrot-on-the-branch-of-a-tree.a8f36cd5.jpg\";","export default __webpack_public_path__ + \"static/media/david-clode-eOSqRq2Qm1c-unsplash.42540cb6.jpg\";","export default __webpack_public_path__ + \"static/media/casey-horner-80UR4DM2Rz0-unsplash.001ae9f7.jpg\";","export default __webpack_public_path__ + \"static/media/van-gogh-roses-nga.8fa9d120.jpg\";","export default __webpack_public_path__ + \"static/media/scott-webb-lYzgtps0UtQ-unsplash.509dd0a5.jpg\";","export default __webpack_public_path__ + \"static/media/travel-sourced-FsmcD6uKcHk-unsplash.97041d06.jpg\";","import { ImageInfo, ImageSource } from './ImageInfo';\r\n\r\nimport img1 from './images/ito-jakuchu-red-parrot-on-the-branch-of-a-tree.jpg';\r\nimport img2 from './images/david-clode-eOSqRq2Qm1c-unsplash.jpg';\r\nimport img3 from './images/casey-horner-80UR4DM2Rz0-unsplash.jpg';\r\nimport img4 from './images/van-gogh-roses-nga.jpg';\r\nimport img5 from './images/scott-webb-lYzgtps0UtQ-unsplash.jpg';\r\nimport img6 from './images/travel-sourced-FsmcD6uKcHk-unsplash.jpg';\r\n\r\n\r\nconst providedImages = [\r\n    new ImageInfo('Red Parrot on the Branch of a Tree', img1, 6, 8, 'Itō Jakuchū', \r\n        new ImageSource('Metropolitan Museum of Art', true, false, 'https://www.metmuseum.org/art/collection/search/57123'), 'Red Parrot'),\r\n    new ImageInfo('Coral', img2, 7, 10, 'David Clode',\r\n        new ImageSource('Unsplash', false, true, 'https://unsplash.com/photos/eOSqRq2Qm1c')),\r\n    new ImageInfo('Starry Sky', img3, 7, 10, 'Casey Horner',\r\n        new ImageSource('Unsplash', false, true, 'https://unsplash.com/photos/80UR4DM2Rz0')),\r\n    new ImageInfo('Roses', img4, 8, 10, 'Vincent van Gogh',\r\n        new ImageSource('National Gallery of Art', true, false, 'https://www.nga.gov/collection/art-object-page.72328.html')),\r\n    new ImageInfo('Succulents', img5, 8, 5, 'Scott Webb',\r\n        new ImageSource('Unsplash', false, true, 'https://unsplash.com/photos/lYzgtps0UtQ')),\r\n    new ImageInfo('Jellyfish', img6, 7, 10, 'Travel Sourced',\r\n        new ImageSource('Unsplash', false, true, 'https://unsplash.com/photos/FsmcD6uKcHk'))\r\n];\r\n\r\nexport default providedImages;","import React, { Component } from 'react';\r\nimport { CustomInput } from 'reactstrap';\r\nimport { ImageInfo } from './ImageInfo';\r\n\r\nimport { clamp } from './util';\r\n\r\nimport presetImages from './providedImages';\r\n\r\n\r\nconst minPuzzleDimension = 2;\r\nconst maxPuzzleDimension = 25;\r\n\r\nexport default class PuzzleControls extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.fileInput = React.createRef();\r\n\r\n        this.selectedPreset = presetImages[0];\r\n        this.userImage = null;\r\n        \r\n        this.handleSelectChange = this.handleSelectChange.bind(this);\r\n        this.handleFileChange = this.handleFileChange.bind(this);\r\n        this.handleDimensionsChange = this.handleDimensionsChange.bind(this);\r\n        this.handleDimensionsBlur = this.handleDimensionsBlur.bind(this);\r\n        this.handleRadioKeyDown = this.handleRadioKeyDown.bind(this);\r\n        this.useUserImage = this.useUserImage.bind(this);\r\n        this.usePresetImage = this.usePresetImage.bind(this);\r\n        this.newPuzzle = this.newPuzzle.bind(this);\r\n        \r\n        this.state = {\r\n            usingUserImage: false,\r\n            invalidUserImage: false,\r\n            rows: presetImages[0].defaultRows,\r\n            cols: presetImages[0].defaultCols\r\n        };\r\n    }\r\n\r\n    get selectedImage () {\r\n        return this.state.usingUserImage ? this.userImage : this.selectedPreset;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.newPuzzle();\r\n    }\r\n\r\n    usePresetImage() {\r\n        this.setState({usingUserImage: false});\r\n    }\r\n\r\n    useUserImage() {\r\n        this.setState({usingUserImage: true});\r\n    }\r\n\r\n    // Maintain arrow key navigation between the radio buttons even though they aren't\r\n    // actually part of the same radio group (so that they can be separate tab stops).\r\n    handleRadioKeyDown(e) {\r\n        switch(e.key) {\r\n            case 'ArrowLeft':\r\n            case 'ArrowUp':\r\n            case 'Left':\r\n            case 'Up':\r\n                if (e.target.id === 'radioBtn2') {\r\n                    document.getElementById('radioBtn1').focus();\r\n                    e.preventDefault();\r\n                }\r\n                return;\r\n            case 'ArrowRight':\r\n            case 'ArrowDown':\r\n            case 'Down':\r\n            case 'Right':\r\n                if (e.target.id === 'radioBtn1') {\r\n                    document.getElementById('radioBtn2').focus();\r\n                    e.preventDefault();\r\n                }\r\n                return;\r\n        }\r\n    }\r\n\r\n    handleSelectChange(e) {\r\n        this.usePresetImage();\r\n\r\n        const select = e.target;\r\n        if (select.selectedIndex !== -1) {\r\n            const img = presetImages[select.selectedIndex];\r\n            this.selectedPreset = img;\r\n            this.setState({rows: img.defaultRows, cols: img.defaultCols});\r\n        }\r\n    }\r\n\r\n    handleFileChange() {\r\n        this.useUserImage();\r\n\r\n        const file = this.fileInput.current.files[0];\r\n        const fileUrl = URL.createObjectURL(file);\r\n\r\n        const testLoader = new Image();\r\n        testLoader.onerror = () => {\r\n            URL.revokeObjectURL(fileUrl);\r\n            this.setState({invalidUserImage: true});\r\n        };\r\n        testLoader.onload = () => {\r\n            if (this.userImage) {\r\n                URL.revokeObjectURL(this.userImage.url);\r\n            }\r\n            const dim = this.generateDefaultDimensions(testLoader.naturalWidth, testLoader.naturalHeight);\r\n            this.userImage = new ImageInfo(file.name, fileUrl, dim.rows, dim.cols);\r\n            this.setState({invalidUserImage: false, rows: dim.rows, cols: dim.cols});\r\n        };\r\n        testLoader.src = fileUrl;\r\n    }\r\n\r\n    // Tries to choose a good default based on the image aspect ratio;\r\n    // could go further and tailor the target rows+columns to the viewport size\r\n    generateDefaultDimensions(width, height) {\r\n        const target = 15;\r\n        const aspect = width / height;\r\n\r\n        // cols = (width / height) * rows\r\n        // cols + rows = target\r\n        const rows = clamp(Math.round(target / (aspect + 1)), minPuzzleDimension, target - minPuzzleDimension);\r\n        const cols = target - rows;\r\n\r\n        return {rows: rows, cols: cols};\r\n    }\r\n\r\n    handleDimensionsChange(e) {\r\n        this.setState({[e.target.name]: e.target.valueAsNumber});\r\n    }\r\n\r\n    handleDimensionsBlur(e) {\r\n        this.setState({[e.target.name]: this.validateDimension(e.target.value)});\r\n    }\r\n\r\n    validateDimension(val) {\r\n        let result = parseInt(val, 10);\r\n        if (isNaN(result) || result < minPuzzleDimension) {\r\n            result = minPuzzleDimension;\r\n        } else if (result > maxPuzzleDimension) {\r\n            result = maxPuzzleDimension;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    newPuzzle() {\r\n        if (this.state.usingUserImage && (!this.userImage || this.state.invalidUserImage)) {\r\n            return;\r\n        }\r\n\r\n        const rows = this.validateDimension(this.state.rows);\r\n        const cols = this.validateDimension(this.state.cols);\r\n\r\n        const img = this.selectedImage;\r\n        document.documentElement.style.setProperty('--puzzle-img', `url(${img.url})`);\r\n        \r\n        const sizeTester = new Image();\r\n        sizeTester.onerror = () => console.log(\"Failed to load image\");\r\n        sizeTester.onload = () => this.props.newPuzzle(sizeTester.naturalWidth, sizeTester.naturalHeight, rows, cols, img);\r\n        sizeTester.src = img.url;\r\n    };\r\n\r\n    renderSelectOptions() {\r\n        const options = [];\r\n        for (let i = 0; i < presetImages.length; i++) {\r\n            const img = presetImages[i];\r\n            options.push(<option key={i} value={img.url}>{img.shortName}</option>);\r\n        }\r\n        return options;\r\n    }\r\n\r\n    render() {\r\n        const rowsVal = isNaN(this.state.rows) ? '' : this.state.rows;\r\n        const colsVal = isNaN(this.state.cols) ? '' : this.state.cols;\r\n\r\n        const presetBtnStyle = this.state.usingUserImage ? 'btn-outline-dark' : 'btn-dark';\r\n        const userBtnStyle = this.state.usingUserImage ? 'btn-dark' : 'btn-outline-dark';\r\n\r\n        return (\r\n            <form className='container mt-4'>\r\n                <div className='form-group row'>\r\n                    <div className='input-group'>\r\n                        <div className='input-group-prepend col-12 col-lg-6 pr-lg-0'>\r\n                            <div className={`btn ${presetBtnStyle} d-flex flex-wrap flex-sm-nowrap align-items-center w-100`} onClick={this.usePresetImage}>\r\n                                <input readOnly className='col-auto' id='radioBtn1' type='radio'\r\n                                    checked={!this.state.usingUserImage} onKeyDown={this.handleRadioKeyDown}/>\r\n                                <label className='col col-sm-4 col-md-3 col-lg-auto col-form-label' htmlFor='radioBtn1'>Choose an image:</label>\r\n                                <div className='w-100 d-sm-none'></div>\r\n                                <label className='sr-only' htmlFor='puzzle-image-select'>Select image</label>\r\n                                <select className='custom-select col mr-lg-4' id='puzzle-image-select' onChange={this.handleSelectChange}>\r\n                                    {this.renderSelectOptions()}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                            \r\n                        <div className='input-group-append col-12 col-lg-6 pl-lg-0'>\r\n                            <div className={`btn ${userBtnStyle} d-flex flex-wrap flex-sm-nowrap align-items-center w-100`} onClick={this.useUserImage}>\r\n                                <input readOnly className='col-auto order-first order-lg-last ml-lg-3' id='radioBtn2' type='radio'\r\n                                    checked={this.state.usingUserImage} onKeyDown={this.handleRadioKeyDown}/>\r\n                                <label className='col col-sm-4 col-md-3 col-lg-auto col-form-label' htmlFor='radioBtn2'>Or use your own:</label>\r\n                                <div className='w-100 d-sm-none'></div>\r\n                                <CustomInput className='col text-left' id='file-input' type='file' accept='image/*' innerRef={this.fileInput}\r\n                                    invalid={this.state.invalidUserImage} onChange={this.handleFileChange}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className='form-group row justify-content-center'>\r\n                    <label className='mr-2 my-2 col-form-label' htmlFor='row-input'>Rows:</label>\r\n                    <input className='mr-2 my-2' id={'row-input'} type='number' min={minPuzzleDimension} max={maxPuzzleDimension}\r\n                        name='rows' value={rowsVal} onChange={this.handleDimensionsChange} onBlur={this.handleDimensionsBlur}/>\r\n                    \r\n                    <label className='mr-2 my-2 col-form-label' htmlFor='col-input'>Columns:</label>\r\n                    <input className='mr-4 my-2' id='col-input' type='number' min={minPuzzleDimension} max={maxPuzzleDimension} \r\n                        name='cols' value={colsVal} onChange={this.handleDimensionsChange} onBlur={this.handleDimensionsBlur}/>\r\n                    \r\n                    <button className='btn btn-dark btn-lg' type='button' disabled={this.state.usingUserImage && this.state.invalidUserImage} onClick={this.newPuzzle}>New puzzle</button>\r\n                </div>\r\n            </form>\r\n        );\r\n    }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Puzzle from './Puzzle';\nimport PuzzleTitle from './PuzzleTitle';\nimport PuzzleControls from './PuzzleControls';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\n\n\nlet puzzleKey = 1;\n\nfunction renderPuzzle(width, height, rows, columns, image) {\n    ReactDOM.render(\n        <React.StrictMode>\n            <PuzzleControls newPuzzle={renderPuzzle} />\n            <PuzzleTitle puzzleImage={image} />\n            <Puzzle key={++puzzleKey} imgWidth={width} imgHeight={height} rows={rows} cols={columns} />\n        </React.StrictMode>,\n        document.getElementById('react-root')\n    );\n}\n\n// Initial render so that PuzzleControls can set up, which then calls renderPuzzle() when loaded (is there a better way to design this?)\nReactDOM.render(\n    <React.StrictMode>\n        <PuzzleControls newPuzzle={renderPuzzle} />\n    </React.StrictMode>,\n    document.getElementById('react-root')\n);\n"],"sourceRoot":""}